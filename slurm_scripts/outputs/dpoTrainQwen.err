wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: jbarrutia006 (jbarrutia006-upv-ehu) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /sorgin1/users/jbarrutia006/viper/wandb/run-20250330_223044-7kquy8xu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Qwen All
wandb: ‚≠êÔ∏è View project at https://wandb.ai/jbarrutia006-upv-ehu/viperDPO
wandb: üöÄ View run at https://wandb.ai/jbarrutia006-upv-ehu/viperDPO/runs/7kquy8xu
2025-03-30 22:30:45,533 - INFO - Loading model and tokenizer...
Unsloth: unsloth/Qwen2.5-Math-7B can only handle sequence lengths of at most 4096.
But with kaiokendev's RoPE scaling of 2.0, it can be magically be extended to 8192!
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:05,  1.76s/it]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:03<00:03,  1.84s/it]Loading checkpoint shards:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:05<00:01,  1.78s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:06<00:00,  1.36s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:06<00:00,  1.52s/it]
Unsloth 2025.3.14 patched 28 layers with 28 QKV layers, 28 O layers and 28 MLP layers.
2025-03-30 22:31:08,740 - INFO - Loading dataset from /sorgin1/users/jbarrutia006/viper/syntData/PrefDatasets/dpo_dataset_all_train.arrow as train and /sorgin1/users/jbarrutia006/viper/syntData/PrefDatasets/dpo_dataset_single_dev.arrow as dev
2025-03-30 22:31:08,759 - INFO - Initializing DPOTrainer...
2025-03-30 22:31:10,377 - WARNING - Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
2025-03-30 22:31:10,380 - INFO - Performing pre-training evaluation on the dev dataset...
  0%|          | 0/250 [00:00<?, ?it/s]  1%|          | 2/250 [00:00<01:30,  2.75it/s]  1%|          | 3/250 [00:02<03:09,  1.30it/s]  2%|‚ñè         | 4/250 [00:02<03:18,  1.24it/s]  2%|‚ñè         | 5/250 [00:03<03:18,  1.23it/s]  2%|‚ñè         | 6/250 [00:05<04:26,  1.09s/it]  3%|‚ñé         | 7/250 [00:06<04:40,  1.15s/it]  3%|‚ñé         | 8/250 [00:07<04:25,  1.10s/it]  4%|‚ñé         | 9/250 [00:08<04:19,  1.08s/it]  4%|‚ñç         | 10/250 [00:09<04:22,  1.09s/it]  4%|‚ñç         | 11/250 [00:10<04:14,  1.07s/it]  5%|‚ñç         | 12/250 [00:11<03:42,  1.07it/s]  5%|‚ñå         | 13/250 [00:12<03:47,  1.04it/s]  6%|‚ñå         | 14/250 [00:13<03:29,  1.13it/s]  6%|‚ñå         | 15/250 [00:13<03:11,  1.23it/s]  6%|‚ñã         | 16/250 [00:14<02:59,  1.30it/s]  7%|‚ñã         | 17/250 [00:15<02:56,  1.32it/s]  7%|‚ñã         | 18/250 [00:16<03:21,  1.15it/s]  8%|‚ñä         | 19/250 [00:17<03:18,  1.16it/s]  8%|‚ñä         | 20/250 [00:17<03:02,  1.26it/s]  8%|‚ñä         | 21/250 [00:18<03:12,  1.19it/s]  9%|‚ñâ         | 22/250 [00:19<03:33,  1.07it/s]  9%|‚ñâ         | 23/250 [00:20<03:37,  1.04it/s] 10%|‚ñâ         | 24/250 [00:21<03:39,  1.03it/s] 10%|‚ñà         | 25/250 [00:22<03:18,  1.14it/s] 10%|‚ñà         | 26/250 [00:23<02:57,  1.26it/s] 11%|‚ñà         | 27/250 [00:23<02:52,  1.29it/s] 11%|‚ñà         | 28/250 [00:24<02:52,  1.29it/s] 12%|‚ñà‚ñè        | 29/250 [00:26<03:27,  1.06it/s] 12%|‚ñà‚ñè        | 30/250 [00:26<03:16,  1.12it/s] 12%|‚ñà‚ñè        | 31/250 [00:27<03:00,  1.21it/s] 13%|‚ñà‚ñé        | 32/250 [00:28<02:59,  1.21it/s] 13%|‚ñà‚ñé        | 33/250 [00:29<03:06,  1.16it/s] 14%|‚ñà‚ñé        | 34/250 [00:29<02:45,  1.30it/s] 14%|‚ñà‚ñç        | 35/250 [00:30<02:56,  1.22it/s] 14%|‚ñà‚ñç        | 36/250 [00:31<03:07,  1.14it/s] 15%|‚ñà‚ñç        | 37/250 [00:32<03:14,  1.09it/s] 15%|‚ñà‚ñå        | 38/250 [00:34<03:55,  1.11s/it] 16%|‚ñà‚ñå        | 39/250 [00:35<03:31,  1.00s/it] 16%|‚ñà‚ñå        | 40/250 [00:35<03:19,  1.05it/s] 16%|‚ñà‚ñã        | 41/250 [00:36<03:18,  1.05it/s] 17%|‚ñà‚ñã        | 42/250 [00:37<03:15,  1.06it/s] 17%|‚ñà‚ñã        | 43/250 [00:38<03:02,  1.14it/s] 18%|‚ñà‚ñä        | 44/250 [00:39<02:54,  1.18it/s] 18%|‚ñà‚ñä        | 45/250 [00:39<02:29,  1.37it/s] 18%|‚ñà‚ñä        | 46/250 [00:40<02:33,  1.33it/s] 19%|‚ñà‚ñâ        | 47/250 [00:41<02:24,  1.40it/s] 19%|‚ñà‚ñâ        | 48/250 [00:41<02:28,  1.36it/s] 20%|‚ñà‚ñâ        | 49/250 [00:42<02:43,  1.23it/s] 20%|‚ñà‚ñà        | 50/250 [00:43<02:43,  1.22it/s] 20%|‚ñà‚ñà        | 51/250 [00:46<04:52,  1.47s/it] 21%|‚ñà‚ñà        | 52/250 [00:48<04:37,  1.40s/it] 21%|‚ñà‚ñà        | 53/250 [00:48<04:08,  1.26s/it] 22%|‚ñà‚ñà‚ñè       | 54/250 [00:49<03:38,  1.12s/it] 22%|‚ñà‚ñà‚ñè       | 55/250 [00:51<03:49,  1.18s/it] 22%|‚ñà‚ñà‚ñè       | 56/250 [00:52<03:46,  1.17s/it] 23%|‚ñà‚ñà‚ñé       | 57/250 [00:53<03:35,  1.12s/it] 23%|‚ñà‚ñà‚ñé       | 58/250 [00:54<03:45,  1.18s/it] 24%|‚ñà‚ñà‚ñé       | 59/250 [00:55<03:23,  1.07s/it] 24%|‚ñà‚ñà‚ñç       | 60/250 [00:55<02:55,  1.08it/s] 24%|‚ñà‚ñà‚ñç       | 61/250 [00:56<02:52,  1.09it/s] 25%|‚ñà‚ñà‚ñç       | 62/250 [00:57<02:50,  1.10it/s] 25%|‚ñà‚ñà‚ñå       | 63/250 [00:58<02:52,  1.09it/s] 26%|‚ñà‚ñà‚ñå       | 64/250 [00:59<02:51,  1.08it/s] 26%|‚ñà‚ñà‚ñå       | 65/250 [01:00<02:37,  1.17it/s] 26%|‚ñà‚ñà‚ñã       | 66/250 [01:01<02:54,  1.05it/s] 27%|‚ñà‚ñà‚ñã       | 67/250 [01:02<03:02,  1.00it/s] 27%|‚ñà‚ñà‚ñã       | 68/250 [01:03<03:05,  1.02s/it] 28%|‚ñà‚ñà‚ñä       | 69/250 [01:04<02:58,  1.01it/s] 28%|‚ñà‚ñà‚ñä       | 70/250 [01:05<02:52,  1.04it/s] 28%|‚ñà‚ñà‚ñä       | 71/250 [01:06<03:08,  1.05s/it] 29%|‚ñà‚ñà‚ñâ       | 72/250 [01:07<02:53,  1.03it/s] 29%|‚ñà‚ñà‚ñâ       | 73/250 [01:08<03:07,  1.06s/it] 30%|‚ñà‚ñà‚ñâ       | 74/250 [01:09<02:57,  1.01s/it] 30%|‚ñà‚ñà‚ñà       | 75/250 [01:11<03:29,  1.20s/it] 30%|‚ñà‚ñà‚ñà       | 76/250 [01:12<03:12,  1.11s/it] 31%|‚ñà‚ñà‚ñà       | 77/250 [01:13<03:16,  1.13s/it] 31%|‚ñà‚ñà‚ñà       | 78/250 [01:14<02:59,  1.04s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 79/250 [01:14<02:43,  1.05it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 80/250 [01:15<02:33,  1.11it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 81/250 [01:17<02:51,  1.02s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 82/250 [01:17<02:46,  1.01it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 83/250 [01:19<02:51,  1.02s/it] 34%|‚ñà‚ñà‚ñà‚ñé      | 84/250 [01:19<02:31,  1.10it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 85/250 [01:20<02:29,  1.10it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 86/250 [01:21<02:22,  1.15it/s] 35%|‚ñà‚ñà‚ñà‚ñç      | 87/250 [01:22<02:18,  1.17it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 88/250 [01:23<02:22,  1.14it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 89/250 [01:23<02:19,  1.15it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 90/250 [01:24<02:16,  1.17it/s] 36%|‚ñà‚ñà‚ñà‚ñã      | 91/250 [01:25<02:18,  1.15it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 92/250 [01:26<02:10,  1.21it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 93/250 [01:27<02:25,  1.08it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 94/250 [01:28<02:36,  1.01s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 95/250 [01:29<02:45,  1.07s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 96/250 [01:30<02:41,  1.05s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 97/250 [01:31<02:33,  1.00s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 98/250 [01:32<02:24,  1.05it/s] 40%|‚ñà‚ñà‚ñà‚ñâ      | 99/250 [01:33<02:06,  1.19it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 100/250 [01:34<02:01,  1.24it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 101/250 [01:35<02:09,  1.15it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 102/250 [01:36<02:13,  1.11it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 103/250 [01:36<02:00,  1.22it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 104/250 [01:37<01:58,  1.24it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 105/250 [01:38<02:03,  1.18it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 106/250 [01:39<02:01,  1.19it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 107/250 [01:40<02:07,  1.12it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 108/250 [01:41<02:33,  1.08s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 109/250 [01:42<02:15,  1.04it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 110/250 [01:43<02:08,  1.09it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 111/250 [01:43<02:00,  1.16it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 112/250 [01:45<02:08,  1.08it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 113/250 [01:46<02:08,  1.07it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 114/250 [01:46<02:02,  1.11it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 115/250 [01:47<02:01,  1.11it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 116/250 [01:48<01:42,  1.31it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 117/250 [01:49<02:15,  1.02s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 118/250 [01:50<02:05,  1.05it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 119/250 [01:51<02:03,  1.06it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 120/250 [01:52<01:48,  1.20it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 121/250 [01:52<01:47,  1.20it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 122/250 [01:53<01:39,  1.28it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 123/250 [01:54<01:34,  1.34it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 124/250 [01:55<01:35,  1.32it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 125/250 [01:55<01:38,  1.27it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 126/250 [01:56<01:32,  1.34it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 127/250 [01:57<01:31,  1.34it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 128/250 [01:58<01:32,  1.32it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 129/250 [01:58<01:36,  1.25it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 130/250 [01:59<01:25,  1.41it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 131/250 [02:00<01:31,  1.30it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 132/250 [02:01<01:32,  1.27it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 133/250 [02:01<01:32,  1.26it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 134/250 [02:02<01:21,  1.42it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 135/250 [02:03<01:41,  1.14it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 136/250 [02:04<01:35,  1.20it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 137/250 [02:05<01:33,  1.21it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 138/250 [02:06<01:34,  1.18it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 139/250 [02:06<01:30,  1.23it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 140/250 [02:07<01:33,  1.18it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 141/250 [02:08<01:32,  1.18it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 142/250 [02:09<01:27,  1.23it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 143/250 [02:10<01:24,  1.26it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 144/250 [02:11<01:26,  1.22it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 145/250 [02:11<01:16,  1.37it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 146/250 [02:12<01:20,  1.29it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 147/250 [02:13<01:21,  1.26it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 148/250 [02:14<01:25,  1.20it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 149/250 [02:14<01:18,  1.28it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 150/250 [02:16<01:28,  1.13it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 151/250 [02:17<01:31,  1.09it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 152/250 [02:18<01:35,  1.03it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 153/250 [02:18<01:27,  1.11it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 154/250 [02:19<01:21,  1.18it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 155/250 [02:20<01:25,  1.12it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 156/250 [02:21<01:25,  1.10it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 157/250 [02:22<01:30,  1.03it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 158/250 [02:23<01:37,  1.06s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 159/250 [02:24<01:26,  1.06it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 160/250 [02:25<01:34,  1.05s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 161/250 [02:26<01:28,  1.01it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 162/250 [02:27<01:15,  1.16it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 163/250 [02:28<01:29,  1.03s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 164/250 [02:29<01:22,  1.04it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 165/250 [02:30<01:18,  1.08it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 166/250 [02:31<01:12,  1.16it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 167/250 [02:31<01:09,  1.19it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 168/250 [02:32<01:11,  1.15it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 169/250 [02:33<01:04,  1.26it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 170/250 [02:34<01:03,  1.26it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 171/250 [02:35<01:09,  1.13it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 172/250 [02:36<01:07,  1.16it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 173/250 [02:37<01:19,  1.03s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 174/250 [02:38<01:07,  1.12it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 175/250 [02:38<01:01,  1.21it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 176/250 [02:39<01:08,  1.08it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 177/250 [02:41<01:12,  1.01it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 178/250 [02:42<01:17,  1.07s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 179/250 [02:43<01:13,  1.04s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 180/250 [02:44<01:07,  1.04it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 181/250 [02:44<00:59,  1.17it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 182/250 [02:45<00:56,  1.20it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 183/250 [02:46<00:58,  1.15it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 184/250 [02:47<00:56,  1.18it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 185/250 [02:48<00:56,  1.16it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 186/250 [02:48<00:52,  1.21it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 187/250 [02:49<00:53,  1.18it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 188/250 [02:51<00:59,  1.03it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 189/250 [02:51<00:54,  1.11it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 190/250 [02:53<01:02,  1.05s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 191/250 [02:53<00:54,  1.09it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 192/250 [02:54<00:50,  1.14it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 193/250 [02:55<00:46,  1.23it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 194/250 [02:55<00:43,  1.30it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 195/250 [02:56<00:41,  1.32it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 196/250 [02:57<00:49,  1.08it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 197/250 [02:58<00:46,  1.15it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 198/250 [02:59<00:43,  1.21it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 199/250 [03:00<00:43,  1.18it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 200/250 [03:01<00:50,  1.01s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 201/250 [03:02<00:51,  1.06s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 202/250 [03:03<00:49,  1.02s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 203/250 [03:04<00:47,  1.02s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 204/250 [03:05<00:40,  1.12it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 205/250 [03:06<00:47,  1.06s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 206/250 [03:08<00:49,  1.12s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 207/250 [03:08<00:44,  1.03s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 208/250 [03:09<00:38,  1.10it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 209/250 [03:10<00:38,  1.06it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 210/250 [03:11<00:33,  1.19it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 211/250 [03:11<00:30,  1.30it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 212/250 [03:12<00:30,  1.24it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 213/250 [03:13<00:29,  1.24it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 214/250 [03:14<00:28,  1.28it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 215/250 [03:14<00:25,  1.38it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 216/250 [03:15<00:25,  1.34it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 217/250 [03:16<00:25,  1.30it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 218/250 [03:17<00:27,  1.17it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 219/250 [03:18<00:29,  1.05it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 220/250 [03:19<00:30,  1.00s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 221/250 [03:20<00:26,  1.08it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 222/250 [03:21<00:26,  1.05it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 223/250 [03:22<00:25,  1.07it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 224/250 [03:23<00:23,  1.13it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 225/250 [03:24<00:23,  1.08it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 226/250 [03:25<00:21,  1.13it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 227/250 [03:26<00:22,  1.00it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 228/250 [03:27<00:22,  1.02s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 229/250 [03:28<00:21,  1.02s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 230/250 [03:29<00:21,  1.07s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 231/250 [03:30<00:20,  1.08s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 232/250 [03:31<00:19,  1.10s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 233/250 [03:32<00:17,  1.03s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 234/250 [03:33<00:16,  1.02s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 235/250 [03:34<00:14,  1.05it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 236/250 [03:35<00:12,  1.09it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 237/250 [03:36<00:11,  1.13it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 238/250 [03:36<00:10,  1.13it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 239/250 [03:37<00:09,  1.13it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 240/250 [03:38<00:07,  1.27it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 241/250 [03:39<00:06,  1.29it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 242/250 [03:40<00:06,  1.24it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 243/250 [03:41<00:06,  1.15it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 244/250 [03:41<00:05,  1.19it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 245/250 [03:42<00:04,  1.19it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 246/250 [03:43<00:03,  1.24it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 247/250 [03:44<00:02,  1.24it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 248/250 [03:45<00:01,  1.09it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 249/250 [03:46<00:01,  1.00s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 250/250 [03:47<00:00,  1.02s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 250/250 [03:47<00:00,  1.10it/s]
2025-03-30 22:35:02,479 - INFO - Initial evaluation results: {'eval_loss': 0.6931473612785339, 'eval_model_preparation_time': 0.0075, 'eval_runtime': 232.0593, 'eval_samples_per_second': 4.309, 'eval_steps_per_second': 1.077, 'eval_rewards/chosen': 0.0, 'eval_rewards/rejected': 0.0, 'eval_rewards/accuracies': 0.0, 'eval_rewards/margins': 0.0, 'eval_logps/chosen': -195.80369567871094, 'eval_logps/rejected': -222.64987182617188, 'eval_logits/chosen': -1.9442288875579834, 'eval_logits/rejected': -1.925130844116211}
2025-03-30 22:35:02,480 - INFO - Starting training...
==((====))==  Unsloth - 2x faster free finetuning | Num GPUs used = 1
   \\   /|    Num examples = 52,487 | Num Epochs = 2 | Total steps = 6,560
O^O/ \_/ \    Batch size per device = 8 | Gradient accumulation steps = 2
\        /    Data Parallel GPUs = 1 | Total batch size (8 x 2 x 1) = 16
 "-____-"     Trainable parameters = 161,480,704/7,777,097,216 (2.08% trained)
  0%|          | 0/6560 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/sorgin1/users/jbarrutia006/viper/scripts/dpo/dpotrain.py", line 158, in <module>
    train_dpo(args)
  File "/sorgin1/users/jbarrutia006/viper/scripts/dpo/dpotrain.py", line 145, in train_dpo
    trainer.train()
  File "/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/transformers/trainer.py", line 2171, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 394, in _fast_inner_training_loop
  File "/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/accelerate/accelerator.py", line 2396, in clip_grad_norm_
    self.unscale_gradients()
  File "/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/accelerate/accelerator.py", line 2340, in unscale_gradients
    self.scaler.unscale_(opt)
  File "/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/torch/amp/grad_scaler.py", line 338, in unscale_
    optimizer_state["found_inf_per_device"] = self._unscale_grads_(
                                              ^^^^^^^^^^^^^^^^^^^^^
  File "/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/torch/amp/grad_scaler.py", line 260, in _unscale_grads_
    raise ValueError("Attempting to unscale FP16 gradients.")
ValueError: Attempting to unscale FP16 gradients.
Traceback (most recent call last):
  File "/sorgin1/users/jbarrutia006/viper/scripts/dpo/dpotrain.py", line 158, in <module>
    train_dpo(args)
  File "/sorgin1/users/jbarrutia006/viper/scripts/dpo/dpotrain.py", line 145, in train_dpo
    trainer.train()
  File "/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/transformers/trainer.py", line 2171, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 394, in _fast_inner_training_loop
  File "/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/accelerate/accelerator.py", line 2396, in clip_grad_norm_
    self.unscale_gradients()
  File "/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/accelerate/accelerator.py", line 2340, in unscale_gradients
    self.scaler.unscale_(opt)
  File "/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/torch/amp/grad_scaler.py", line 338, in unscale_
    optimizer_state["found_inf_per_device"] = self._unscale_grads_(
                                              ^^^^^^^^^^^^^^^^^^^^^
  File "/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/torch/amp/grad_scaler.py", line 260, in _unscale_grads_
    raise ValueError("Attempting to unscale FP16 gradients.")
ValueError: Attempting to unscale FP16 gradients.
srun: error: localhost: task 0: Exited with exit code 1
