2025-06-05 15:41:43,095 - INFO - {'multiprocessing': False, 'path_pretrained_models': './pretrained_models', 'execute_code': False, 'dataset': {'dataset_name': 'GQA', 'data_path': './data/gqa', 'split': 'testdev', 'max_samples': None, 'batch_size': 8, 'start_sample': 0, 'testing': False}, 'load_models': {'maskrcnn': False, 'clip': False, 'glip': False, 'owlvit': False, 'tcl': False, 'gpt3_qa': False, 'gpt3_general': False, 'depth': False, 'blip': False, 'saliency': False, 'xvlm': False, 'codex': False, 'codellama': True, 'codellama_Q': False, 'llm_query': False, 'llm_guess': False, 'gpt3_list': False, 'qa': False, 'guess': False, 'gpt3_guess': False}, 'detect_thresholds': {'glip': 0.5, 'maskrcnn': 0.8, 'owlvit': 0.1}, 'ratio_box_area_to_image_area': 0.0, 'crop_larger_margin': True, 'verify_property': {'model': 'xvlm', 'thresh_clip': 0.6, 'thresh_tcl': 0.25, 'thresh_xvlm': 0.6}, 'best_match_model': 'xvlm', 'gpt3': {'n_votes': 1, 'qa_prompt': './prompts/gpt3/gpt3_qa.txt', 'guess_prompt': './prompts/gpt3/gpt3_process_guess.txt', 'temperature': 0.0, 'model': 'text-davinci-003'}, 'codex': {'temperature': 0, 'best_of': 1, 'max_tokens': 512, 'prompt': './prompts/benchmarks/gqa.prompt', 'model': 'codellama', 'extra_context': None, 'model_name': 'codellama/CodeLlama-7b-Instruct-hf', 'adapter': None}, 'save': False, 'save_new_results': True, 'save_codex': True, 'results_dir': './results/gqa/codex_results/', 'use_cache': True, 'clear_cache': True, 'log_every': 20, 'wandb': False, 'blip_half_precision': False, 'blip_v2_model_type': 'blip2-flan-t5-xl', 'glip_model_type': 'large', 'use_fixed_code': False, 'fixed_code_file': './prompts/fixed_code/blip2.prompt', 'cognition': {'is_setted': False}, 'use_cached_codex': False, 'use_cache_codex': False}
2025-06-05 15:41:46,794 - INFO - Starting main
SELECTED CONFIG FILES: gqa/general_config,config_codellama,gqa/save_codex,gqa/testdev
LOADING MODEL: DISABLED
INFO 06-05 15:41:52 __init__.py:183] Automatically detected platform cuda.
2025-06-05 15:41:53,445 - INFO - Using dtype=bfloat16 based on compute capability=8.0
INFO 06-05 15:42:04 config.py:526] This model supports multiple tasks: {'generate', 'embed', 'classify', 'score', 'reward'}. Defaulting to 'generate'.
INFO 06-05 15:42:04 llm_engine.py:232] Initializing a V0 LLM engine (v0.7.1) with config: model='codellama/CodeLlama-7b-Instruct-hf', speculative_config=None, tokenizer='codellama/CodeLlama-7b-Instruct-hf', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=16384, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=codellama/CodeLlama-7b-Instruct-hf, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":[],"compile_sizes":[],"cudagraph_capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 06-05 15:42:05 cuda.py:235] Using Flash Attention backend.
INFO 06-05 15:42:06 model_runner.py:1111] Starting to load model codellama/CodeLlama-7b-Instruct-hf...
INFO 06-05 15:42:06 weight_utils.py:251] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  50% Completed | 1/2 [01:28<01:28, 88.28s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:59<00:00, 54.60s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [01:59<00:00, 59.65s/it]

INFO 06-05 15:44:06 model_runner.py:1116] Loading model weights took 12.5562 GB
INFO 06-05 15:44:08 worker.py:266] Memory profiling takes 1.41 seconds
INFO 06-05 15:44:08 worker.py:266] the current vLLM instance can use total_gpu_memory (79.15GiB) x gpu_memory_utilization (0.90) = 71.24GiB
INFO 06-05 15:44:08 worker.py:266] model weights take 12.56GiB; non_torch_memory takes 0.09GiB; PyTorch activation peak memory takes 1.39GiB; the rest of the memory reserved for KV Cache is 57.20GiB.
INFO 06-05 15:44:08 executor_base.py:108] # CUDA blocks: 7321, # CPU blocks: 512
INFO 06-05 15:44:08 executor_base.py:113] Maximum concurrency for 16384 tokens per request: 7.15x
INFO 06-05 15:44:09 model_runner.py:1435] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:00<00:20,  1.67it/s]Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:01<00:17,  1.94it/s]Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:01<00:15,  2.04it/s]Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:01<00:14,  2.09it/s]Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:02<00:14,  2.12it/s]Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:02<00:13,  2.14it/s]Capturing CUDA graph shapes:  20%|██        | 7/35 [00:03<00:13,  2.14it/s]Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:03<00:12,  2.15it/s]Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:04<00:12,  2.16it/s]Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:04<00:11,  2.13it/s]Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:05<00:11,  2.15it/s]Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:05<00:10,  2.17it/s]Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:06<00:10,  2.17it/s]Capturing CUDA graph shapes:  40%|████      | 14/35 [00:06<00:09,  2.19it/s]Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:07<00:09,  2.20it/s]Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:07<00:08,  2.21it/s]Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:07<00:08,  2.22it/s]Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:08<00:07,  2.24it/s]Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:08<00:07,  2.24it/s]Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:09<00:06,  2.25it/s]Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:09<00:06,  2.26it/s]Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:10<00:05,  2.27it/s]Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:10<00:05,  2.28it/s]Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:10<00:04,  2.29it/s]Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:11<00:04,  2.30it/s]Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:11<00:03,  2.31it/s]Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:12<00:03,  2.32it/s]Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:12<00:03,  2.33it/s]Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:13<00:02,  2.33it/s]Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:13<00:02,  2.34it/s]Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:13<00:01,  2.34it/s]Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:14<00:01,  2.34it/s]Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:14<00:00,  2.34it/s]Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:15<00:00,  2.34it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:15<00:00,  2.34it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:15<00:00,  2.23it/s]
INFO 06-05 15:44:25 model_runner.py:1563] Graph capturing finished in 16 secs, took 0.85 GiB
INFO 06-05 15:44:25 llm_engine.py:429] init engine (profile, create kv cache, warmup model) took 18.60 seconds
2025-06-05 15:44:25,477 - INFO - Models successfully loaded
2025-06-05 15:44:25,477 - WARNING - [Memory(location=cache/joblib)]: Flushing completely the cache
2025-06-05 15:44:25,945 - INFO - Dataset loaded
modelo: <class 'vision_models.codellama'> , proceso:  codellama
{'codellama': <function make_fn.<locals>._function at 0x7f27f431c0e0>}
  0%|                                                                      | 0/1573 [00:00<?, ?it/s]2025-06-05 15:44:26,455 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:32, 13.16s/it, est. speed input: 262.45 toks/s, output: 38.91 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2102.55 toks/s, output: 311.31 toks/s]
/sorgin1/users/jbarrutia006/viper/src/main_project_slurm.py:280: UserWarning: Not executing code! This is only generating the code. We set the flag 'execute_code' to False by default, because executing code generated by a language model can be dangerous. Set the flag 'execute_code' to True if you want to execute it.
  warnings.warn("Not executing code! This is only generating the code. We set the flag "
  0%|                                                            | 1/1573 [00:13<5:59:22, 13.72s/it]2025-06-05 15:44:39,859 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.08s/it, est. speed input: 264.20 toks/s, output: 39.15 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.63s/it, est. speed input: 2114.84 toks/s, output: 313.21 toks/s]
  0%|                                                            | 2/1573 [00:27<5:52:59, 13.48s/it]2025-06-05 15:44:53,205 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.99 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.41 toks/s, output: 312.69 toks/s]
  0%|1                                                           | 3/1573 [00:40<5:51:23, 13.43s/it]2025-06-05 15:45:06,477 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.73 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.41 toks/s, output: 312.55 toks/s]
  0%|1                                                           | 4/1573 [00:53<5:49:36, 13.37s/it]2025-06-05 15:45:19,878 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.03 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.40 toks/s, output: 312.55 toks/s]
  0%|1                                                           | 5/1573 [01:07<5:49:41, 13.38s/it]2025-06-05 15:45:33,196 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.09s/it, est. speed input: 264.45 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.60 toks/s, output: 312.79 toks/s]
  0%|2                                                           | 6/1573 [01:20<5:48:48, 13.36s/it]2025-06-05 15:45:46,715 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.91 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.81 toks/s, output: 312.77 toks/s]
  0%|2                                                           | 7/1573 [01:33<5:49:58, 13.41s/it]2025-06-05 15:46:00,132 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.08s/it, est. speed input: 264.31 toks/s, output: 39.16 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.63s/it, est. speed input: 2114.74 toks/s, output: 313.25 toks/s]
  1%|3                                                           | 8/1573 [01:47<5:49:39, 13.41s/it]2025-06-05 15:46:13,410 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.99 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.51 toks/s, output: 312.60 toks/s]
  1%|3                                                           | 9/1573 [02:00<5:48:36, 13.37s/it]2025-06-05 15:46:26,692 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.10 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.99 toks/s, output: 312.64 toks/s]
  1%|3                                                          | 10/1573 [02:13<5:47:38, 13.35s/it]2025-06-05 15:46:40,045 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.52 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.99 toks/s, output: 312.77 toks/s]
  1%|4                                                          | 11/1573 [02:27<5:47:25, 13.35s/it]2025-06-05 15:46:53,240 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.81 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.82 toks/s, output: 312.75 toks/s]
  1%|4                                                          | 12/1573 [02:40<5:46:01, 13.30s/it]2025-06-05 15:47:06,521 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.13 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.34 toks/s, output: 312.76 toks/s]
  1%|4                                                          | 13/1573 [02:53<5:45:39, 13.29s/it]2025-06-05 15:47:19,913 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.44 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.15 toks/s, output: 312.67 toks/s]
  1%|5                                                          | 14/1573 [03:07<5:46:13, 13.32s/it]2025-06-05 15:47:33,123 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.21 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.27 toks/s, output: 312.59 toks/s]
  1%|5                                                          | 15/1573 [03:20<5:45:08, 13.29s/it]2025-06-05 15:47:46,433 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.11s/it, est. speed input: 264.00 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.25 toks/s, output: 312.52 toks/s]
  1%|6                                                          | 16/1573 [03:33<5:45:04, 13.30s/it]2025-06-05 15:47:59,774 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.11s/it, est. speed input: 264.79 toks/s, output: 39.06 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.50 toks/s, output: 312.47 toks/s]
  1%|6                                                          | 17/1573 [03:46<5:45:12, 13.31s/it]2025-06-05 15:48:13,067 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.27 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2113.11 toks/s, output: 312.66 toks/s]
  1%|6                                                          | 18/1573 [04:00<5:44:47, 13.30s/it]2025-06-05 15:48:26,345 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.07s/it, est. speed input: 264.43 toks/s, output: 39.16 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.63s/it, est. speed input: 2114.22 toks/s, output: 313.30 toks/s]
  1%|7                                                          | 19/1573 [04:13<5:44:11, 13.29s/it]2025-06-05 15:48:39,579 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.91 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.54 toks/s, output: 312.78 toks/s]
  1%|7                                                          | 20/1573 [04:26<5:43:40, 13.28s/it]2025-06-05 15:48:52,828 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.75 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2113.28 toks/s, output: 312.58 toks/s]
  1%|7                                                          | 21/1573 [04:40<5:43:17, 13.27s/it]2025-06-05 15:49:06,056 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.09 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.59 toks/s, output: 312.71 toks/s]
  1%|8                                                          | 22/1573 [04:53<5:42:41, 13.26s/it]2025-06-05 15:49:19,272 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.09s/it, est. speed input: 263.93 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.89 toks/s, output: 312.79 toks/s]
  1%|8                                                          | 23/1573 [05:06<5:42:07, 13.24s/it]2025-06-05 15:49:33,049 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.06 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.21 toks/s, output: 312.68 toks/s]
  2%|9                                                          | 24/1573 [05:20<5:46:04, 13.41s/it]2025-06-05 15:49:46,323 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.96 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.49 toks/s, output: 312.66 toks/s]
  2%|9                                                          | 25/1573 [05:33<5:44:50, 13.37s/it]2025-06-05 15:49:59,707 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.41 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2113.55 toks/s, output: 312.73 toks/s]
  2%|9                                                          | 26/1573 [05:46<5:44:44, 13.37s/it]2025-06-05 15:50:12,999 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.14 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.16 toks/s, output: 312.69 toks/s]
  2%|#                                                          | 27/1573 [06:00<5:43:54, 13.35s/it]2025-06-05 15:50:26,294 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.03 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.88 toks/s, output: 312.55 toks/s]
  2%|#                                                          | 28/1573 [06:13<5:43:19, 13.33s/it]2025-06-05 15:50:39,494 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.08s/it, est. speed input: 264.53 toks/s, output: 39.14 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2114.99 toks/s, output: 313.15 toks/s]
  2%|#                                                          | 29/1573 [06:26<5:41:54, 13.29s/it]2025-06-05 15:50:52,734 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:34, 13.44s/it, est. speed input: 257.21 toks/s, output: 38.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.68s/it, est. speed input: 2058.04 toks/s, output: 304.66 toks/s]
  2%|#1                                                         | 30/1573 [06:40<5:44:07, 13.38s/it]2025-06-05 15:51:06,317 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.03 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.25 toks/s, output: 312.73 toks/s]
  2%|#1                                                         | 31/1573 [06:53<5:42:47, 13.34s/it]2025-06-05 15:51:19,851 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.11s/it, est. speed input: 263.90 toks/s, output: 39.06 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.50 toks/s, output: 312.49 toks/s]
  2%|#2                                                         | 32/1573 [07:07<5:44:09, 13.40s/it]2025-06-05 15:51:33,101 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.91 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.65 toks/s, output: 312.59 toks/s]
  2%|#2                                                         | 33/1573 [07:20<5:42:44, 13.35s/it]2025-06-05 15:51:46,649 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.09s/it, est. speed input: 264.21 toks/s, output: 39.11 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.54 toks/s, output: 312.85 toks/s]
  2%|#2                                                         | 34/1573 [07:33<5:43:55, 13.41s/it]2025-06-05 15:52:00,158 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.09s/it, est. speed input: 263.99 toks/s, output: 39.11 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.42 toks/s, output: 312.87 toks/s]
  2%|#3                                                         | 35/1573 [07:47<5:44:28, 13.44s/it]2025-06-05 15:52:13,791 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.09s/it, est. speed input: 263.92 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2113.21 toks/s, output: 312.79 toks/s]
  2%|#3                                                         | 36/1573 [08:00<5:45:45, 13.50s/it]2025-06-05 15:52:27,355 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.73 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.24 toks/s, output: 312.65 toks/s]
  2%|#3                                                         | 37/1573 [08:14<5:46:05, 13.52s/it]2025-06-05 15:52:41,062 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.09s/it, est. speed input: 264.15 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.32 toks/s, output: 312.79 toks/s]
  2%|#4                                                         | 38/1573 [08:28<5:47:15, 13.57s/it]2025-06-05 15:52:54,476 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.03 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.07 toks/s, output: 312.56 toks/s]
  2%|#4                                                         | 39/1573 [08:41<5:45:54, 13.53s/it]2025-06-05 15:53:07,854 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.82 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.83 toks/s, output: 312.67 toks/s]
  3%|#5                                                         | 40/1573 [08:55<5:44:28, 13.48s/it]2025-06-05 15:53:21,070 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.11s/it, est. speed input: 264.09 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.64 toks/s, output: 312.53 toks/s]
  3%|#5                                                         | 41/1573 [09:08<5:42:15, 13.40s/it]2025-06-05 15:53:35,213 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.09s/it, est. speed input: 263.97 toks/s, output: 39.11 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.78 toks/s, output: 312.85 toks/s]
  3%|#5                                                         | 42/1573 [09:22<5:47:33, 13.62s/it]2025-06-05 15:53:48,586 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.81 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.67 toks/s, output: 312.66 toks/s]
  3%|#6                                                         | 43/1573 [09:35<5:45:30, 13.55s/it]2025-06-05 15:54:01,836 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.17 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2113.24 toks/s, output: 312.63 toks/s]
  3%|#6                                                         | 44/1573 [09:49<5:43:00, 13.46s/it]2025-06-05 15:54:15,104 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.09s/it, est. speed input: 263.96 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2113.29 toks/s, output: 312.83 toks/s]
  3%|#6                                                         | 45/1573 [10:02<5:41:15, 13.40s/it]2025-06-05 15:54:28,384 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.24 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2113.02 toks/s, output: 312.71 toks/s]
  3%|#7                                                         | 46/1573 [10:15<5:40:09, 13.37s/it]2025-06-05 15:54:42,285 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.83 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.95 toks/s, output: 312.77 toks/s]
  3%|#7                                                         | 47/1573 [10:29<5:43:59, 13.53s/it]2025-06-05 15:54:55,718 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.78 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.77 toks/s, output: 312.71 toks/s]
  3%|#8                                                         | 48/1573 [10:42<5:43:05, 13.50s/it]2025-06-05 15:55:08,945 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.81 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.88 toks/s, output: 312.57 toks/s]
  3%|#8                                                         | 49/1573 [10:56<5:40:50, 13.42s/it]2025-06-05 15:55:22,217 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.97 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.82 toks/s, output: 312.66 toks/s]
  3%|#8                                                         | 50/1573 [11:09<5:39:28, 13.37s/it]2025-06-05 15:55:35,455 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.11s/it, est. speed input: 264.47 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.17 toks/s, output: 312.53 toks/s]
  3%|#9                                                         | 51/1573 [11:22<5:38:14, 13.33s/it]2025-06-05 15:55:48,755 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.44 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2113.37 toks/s, output: 312.77 toks/s]
  3%|#9                                                         | 52/1573 [11:35<5:37:41, 13.32s/it]2025-06-05 15:56:01,964 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.02 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.50 toks/s, output: 312.63 toks/s]
  3%|#9                                                         | 53/1573 [11:49<5:36:39, 13.29s/it]2025-06-05 15:56:15,201 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.45 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.16 toks/s, output: 312.78 toks/s]
  3%|##                                                         | 54/1573 [12:02<5:35:59, 13.27s/it]2025-06-05 15:56:28,373 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.07s/it, est. speed input: 264.20 toks/s, output: 39.16 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.63s/it, est. speed input: 2114.26 toks/s, output: 313.30 toks/s]
  3%|##                                                         | 55/1573 [12:15<5:34:51, 13.24s/it]2025-06-05 15:56:41,582 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.08s/it, est. speed input: 264.26 toks/s, output: 39.15 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.63s/it, est. speed input: 2114.75 toks/s, output: 313.19 toks/s]
  4%|##1                                                        | 56/1573 [12:28<5:34:27, 13.23s/it]2025-06-05 15:56:55,360 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.90 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.85 toks/s, output: 312.75 toks/s]
  4%|##1                                                        | 57/1573 [12:42<5:38:32, 13.40s/it]2025-06-05 15:57:08,648 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.37 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.26 toks/s, output: 312.60 toks/s]
  4%|##1                                                        | 58/1573 [12:55<5:37:31, 13.37s/it]2025-06-05 15:57:21,838 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.88 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2113.15 toks/s, output: 312.65 toks/s]
  4%|##2                                                        | 59/1573 [13:09<5:35:56, 13.31s/it]2025-06-05 15:57:35,044 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:34, 13.45s/it, est. speed input: 257.09 toks/s, output: 38.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.68s/it, est. speed input: 2057.33 toks/s, output: 304.60 toks/s]
  4%|##2                                                        | 60/1573 [13:22<5:37:34, 13.39s/it]2025-06-05 15:57:48,619 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.13s/it, est. speed input: 263.64 toks/s, output: 39.00 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2108.70 toks/s, output: 312.01 toks/s]
  4%|##2                                                        | 61/1573 [13:35<5:36:21, 13.35s/it]2025-06-05 15:58:01,864 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.11s/it, est. speed input: 263.62 toks/s, output: 39.05 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.55 toks/s, output: 312.43 toks/s]
  4%|##3                                                        | 62/1573 [13:49<5:35:12, 13.31s/it]2025-06-05 15:58:15,077 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.91 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.47 toks/s, output: 312.60 toks/s]
  4%|##3                                                        | 63/1573 [14:02<5:34:11, 13.28s/it]2025-06-05 15:58:28,264 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.95 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.10 toks/s, output: 312.55 toks/s]
  4%|##4                                                        | 64/1573 [14:15<5:33:16, 13.25s/it]2025-06-05 15:58:41,450 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.37 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.33 toks/s, output: 312.60 toks/s]
  4%|##4                                                        | 65/1573 [14:28<5:32:32, 13.23s/it]2025-06-05 15:58:54,718 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.89 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.05 toks/s, output: 312.66 toks/s]
  4%|##4                                                        | 66/1573 [14:41<5:32:36, 13.24s/it]2025-06-05 15:59:07,941 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.08s/it, est. speed input: 264.32 toks/s, output: 39.16 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.63s/it, est. speed input: 2114.74 toks/s, output: 313.26 toks/s]
  4%|##5                                                        | 67/1573 [14:55<5:32:01, 13.23s/it]2025-06-05 15:59:21,156 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.08s/it, est. speed input: 264.06 toks/s, output: 39.14 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2114.66 toks/s, output: 313.14 toks/s]
  4%|##5                                                        | 68/1573 [15:08<5:31:44, 13.23s/it]2025-06-05 15:59:34,416 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.89 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.27 toks/s, output: 312.75 toks/s]
  4%|##5                                                        | 69/1573 [15:21<5:31:54, 13.24s/it]2025-06-05 15:59:47,619 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.00 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.08 toks/s, output: 312.60 toks/s]
  4%|##6                                                        | 70/1573 [15:34<5:31:26, 13.23s/it]2025-06-05 16:00:01,032 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.11 toks/s, output: 39.09 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.89 toks/s, output: 312.74 toks/s]
  5%|##6                                                        | 71/1573 [15:48<5:32:32, 13.28s/it]2025-06-05 16:00:14,470 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 264.80 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.87 toks/s, output: 312.66 toks/s]
  5%|##7                                                        | 72/1573 [16:01<5:33:29, 13.33s/it]2025-06-05 16:00:27,658 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.07s/it, est. speed input: 264.22 toks/s, output: 39.17 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.63s/it, est. speed input: 2115.80 toks/s, output: 313.33 toks/s]
  5%|##7                                                        | 73/1573 [16:14<5:32:00, 13.28s/it]2025-06-05 16:00:40,917 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.82 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.45 toks/s, output: 312.67 toks/s]
  5%|##7                                                        | 74/1573 [16:28<5:31:50, 13.28s/it]2025-06-05 16:00:54,738 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.09s/it, est. speed input: 264.16 toks/s, output: 39.11 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.57 toks/s, output: 312.89 toks/s]
  5%|##8                                                        | 75/1573 [16:41<5:35:33, 13.44s/it]2025-06-05 16:01:07,913 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.10s/it, est. speed input: 263.78 toks/s, output: 39.08 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2112.17 toks/s, output: 312.62 toks/s]
  5%|##8                                                        | 76/1573 [16:55<5:33:26, 13.36s/it]2025-06-05 16:01:21,103 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.08s/it, est. speed input: 264.21 toks/s, output: 39.15 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.63s/it, est. speed input: 2115.05 toks/s, output: 313.22 toks/s]
  5%|##8                                                        | 77/1573 [17:08<5:31:43, 13.30s/it]2025-06-05 16:01:34,264 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.08s/it, est. speed input: 264.26 toks/s, output: 39.15 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.63s/it, est. speed input: 2114.73 toks/s, output: 313.19 toks/s]
  5%|##9                                                        | 78/1573 [17:21<5:30:26, 13.26s/it]2025-06-05 16:01:47,500 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.11s/it, est. speed input: 263.99 toks/s, output: 39.07 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.45 toks/s, output: 312.51 toks/s]
  5%|##9                                                        | 79/1573 [17:34<5:30:15, 13.26s/it]2025-06-05 16:02:00,701 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.09s/it, est. speed input: 264.07 toks/s, output: 39.10 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.84 toks/s, output: 312.79 toks/s]
  5%|###                                                        | 80/1573 [17:47<5:29:28, 13.24s/it]2025-06-05 16:02:13,907 - INFO - Not using adapter

Processed prompts:   0%|          | 0/8 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 1/8 [00:13<01:31, 13.11s/it, est. speed input: 264.00 toks/s, output: 39.05 toks/s][AProcessed prompts: 100%|██████████| 8/8 [00:13<00:00,  1.64s/it, est. speed input: 2111.10 toks/s, output: 312.43 toks/s]
2025-06-05 16:02:27,059 - ERROR - Error de llama: list index out of range
  5%|###                                                        | 80/1573 [18:01<5:36:16, 13.51s/it]
Traceback (most recent call last):
  File "/sorgin1/users/jbarrutia006/viper/src/main_project_slurm.py", line 279, in main
    results = [(None, c) for c in codes]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not iterable
Error de llama: list index out of range
Exception: 'NoneType' object is not iterable
Completing logging and exiting...
Final accuracy: 0.1671875
2025-06-05 16:02:27,076 - INFO - Saving results to codellama___06-05_16-02.csv
[rank0]:[W605 16:02:27.709953906 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
2025-06-05 16:02:32,733 - INFO - {'multiprocessing': False, 'path_pretrained_models': './pretrained_models', 'execute_code': True, 'dataset': {'dataset_name': 'GQA', 'data_path': './data/gqa', 'split': 'testdev', 'max_samples': None, 'batch_size': 32, 'start_sample': 0, 'testing': False}, 'load_models': {'maskrcnn': True, 'clip': False, 'glip': True, 'owlvit': False, 'tcl': False, 'gpt3_qa': False, 'gpt3_general': False, 'depth': False, 'blip': True, 'saliency': False, 'xvlm': True, 'codex': False, 'codellama': False, 'codellama_Q': False, 'llm_query': False, 'llm_guess': False, 'gpt3_list': False, 'qa': False, 'guess': False}, 'detect_thresholds': {'glip': 0.5, 'maskrcnn': 0.8, 'owlvit': 0.1}, 'ratio_box_area_to_image_area': 0.0, 'crop_larger_margin': True, 'verify_property': {'model': 'xvlm', 'thresh_clip': 0.6, 'thresh_tcl': 0.25, 'thresh_xvlm': 0.6}, 'best_match_model': 'xvlm', 'gpt3': {'n_votes': 1, 'qa_prompt': './prompts/gpt3/gpt3_qa.txt', 'guess_prompt': './prompts/gpt3/gpt3_process_guess.txt', 'temperature': 0.0, 'model': 'text-davinci-003'}, 'codex': {'temperature': 0.0, 'best_of': 1, 'max_tokens': 512, 'prompt': './prompts/benchmarks/gqa.prompt', 'model': 'gpt-3.5-turbo', 'extra_context': None}, 'save': True, 'save_new_results': True, 'save_codex': False, 'results_dir': './results/gqa/all/', 'use_cache': True, 'clear_cache': True, 'log_every': 20, 'wandb': False, 'blip_half_precision': False, 'blip_v2_model_type': 'blip2-flan-t5-xl', 'glip_model_type': 'large', 'use_fixed_code': False, 'fixed_code_file': './prompts/fixed_code/blip2.prompt', 'cognition': {'is_setted': False}, 'use_cached_codex': True, 'cached_codex_path': 'results/gqa/codex_results/testdev/codellama___06-05_16-02.csv'}
2025-06-05 16:02:35,503 - INFO - Starting main
SELECTED CONFIG FILES: gqa/general_config,gqa/testdev
LOADING MODEL: ENABLED
INFO 06-05 16:02:39 __init__.py:183] Automatically detected platform cuda.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.81s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.31s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.38s/it]
2025-06-05 16:05:04,027 - INFO - BLIP loaded
/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/torch/functional.py:534: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3595.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/sorgin1/users/jbarrutia006/viper/GLIP/maskrcnn_benchmark/utils/checkpoint.py:115: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(f, map_location=torch.device("cpu"))
2025-06-05 16:06:14,259 - INFO - GLIP model is loaded in cuda:0
/sorgin1/users/jbarrutia006/viper/src/vision_models.py:2588: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(path_checkpoint, map_location='cpu')
2025-06-05 16:06:17,652 - INFO - Models successfully loaded
2025-06-05 16:06:17,652 - WARNING - [Memory(location=cache/joblib)]: Flushing completely the cache
2025-06-05 16:06:18,112 - INFO - Dataset loaded
modelo: <class 'vision_models.BLIPModel'> , proceso:  blip
VISION BACKBONE USE GRADIENT CHECKPOINTING:  False
LANGUAGE BACKBONE USE GRADIENT CHECKPOINTING:  False
EARLY FUSION ON, USING MHA-B
EARLY FUSION ON, USING MHA-B
EARLY FUSION ON, USING MHA-B
EARLY FUSION ON, USING MHA-B
EARLY FUSION ON, USING MHA-B
EARLY FUSION ON, USING MHA-B
EARLY FUSION ON, USING MHA-B
EARLY FUSION ON, USING MHA-B
modelo: <class 'vision_models.GLIPModel'> , proceso:  glip
modelo: <class 'vision_models.MaskRCNNModel'> , proceso:  maskrcnn
modelo: <class 'vision_models.XVLMModel'> , proceso:  xvlm
{'blip': <function make_fn.<locals>._function at 0x7fe1d2a9fb00>, 'glip': <function make_fn.<locals>._function at 0x7fdee04a8180>, 'maskrcnn': <function make_fn.<locals>._function at 0x7fdee2a0b920>, 'xvlm': <function make_fn.<locals>._function at 0x7fdee0267b00>}
  0%|                                                                       | 0/394 [00:00<?, ?it/s] 13%|#######8                                                      | 50/394 [00:10<01:09,  4.95it/s] 26%|###############6                                             | 101/394 [00:20<00:58,  5.00it/s] 41%|########################9                                    | 161/394 [00:30<00:42,  5.43it/s] 56%|##################################2                          | 221/394 [00:40<00:31,  5.58it/s] 73%|############################################2                | 286/394 [00:50<00:18,  5.88it/s] 89%|######################################################3      | 351/394 [01:01<00:07,  5.86it/s]100%|#############################################################| 394/394 [01:08<00:00,  5.73it/s]
Error computing accuracy: Prediction and ground truth lists must have the same length. Got 640 and 12578.
Traceback (most recent call last):
  File "/sorgin1/users/jbarrutia006/viper/src/main_project_slurm.py", line 332, in <module>
    main()
  File "/sorgin1/users/jbarrutia006/viper/src/main_project_slurm.py", line 320, in main
    all_data = [all_sample_ids, all_queries, all_results, all_img_paths, all_answers, all_codes,score_vector , accuracy]
                                                                                                ^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'score_vector' where it is not associated with a value
srun: error: localhost: task 0: Exited with exit code 1
