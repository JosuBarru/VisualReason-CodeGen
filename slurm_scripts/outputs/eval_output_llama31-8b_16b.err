INFO:root:{'multiprocessing': False, 'path_pretrained_models': './pretrained_models', 'execute_code': True, 'dataset': {'dataset_name': 'GQA', 'data_path': './data/gqa', 'split': 'train', 'max_samples': 12600, 'batch_size': 16, 'start_sample': 0, 'testing': False}, 'load_models': {'maskrcnn': True, 'clip': False, 'glip': True, 'owlvit': False, 'tcl': False, 'gpt3_qa': False, 'gpt3_general': False, 'depth': False, 'blip': True, 'saliency': False, 'xvlm': True, 'codex': False, 'codellama': False, 'codellama_Q': False, 'llm_query': False, 'llm_guess': False, 'gpt3_list': False, 'qa': False, 'guess': False}, 'detect_thresholds': {'glip': 0.5, 'maskrcnn': 0.8, 'owlvit': 0.1}, 'ratio_box_area_to_image_area': 0.0, 'crop_larger_margin': True, 'verify_property': {'model': 'xvlm', 'thresh_clip': 0.6, 'thresh_tcl': 0.25, 'thresh_xvlm': 0.6}, 'best_match_model': 'xvlm', 'gpt3': {'n_votes': 1, 'qa_prompt': './prompts/gpt3/gpt3_qa.txt', 'guess_prompt': './prompts/gpt3/gpt3_process_guess.txt', 'temperature': 0.0, 'model': 'text-davinci-003'}, 'codex': {'temperature': 0.0, 'best_of': 1, 'max_tokens': 512, 'prompt': './prompts/benchmarks/gqa.prompt', 'model': 'gpt-3.5-turbo', 'extra_context': None}, 'save': True, 'save_new_results': True, 'save_codex': False, 'results_dir': './results/gqa/all/', 'use_cache': True, 'clear_cache': True, 'log_every': 20, 'wandb': False, 'blip_half_precision': False, 'blip_v2_model_type': 'blip2-flan-t5-xl', 'glip_model_type': 'large', 'use_fixed_code': False, 'fixed_code_file': './prompts/fixed_code/blip2.prompt', 'cognition': {'is_setted': False}, 'use_cached_codex': True, 'cached_codex_path': 'results/gqa/codex_results/train/llama31-8B-16b.csv'}
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.73it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.56it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.39it/s]
INFO:root:BLIP loaded
/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/torch/functional.py:534: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3595.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/sorgin1/users/jbarrutia006/viper/GLIP/maskrcnn_benchmark/utils/checkpoint.py:115: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(f, map_location=torch.device("cpu"))
INFO:root:GLIP model is loaded in cuda:0
/sorgin1/users/jbarrutia006/viper/src/vision_models.py:2107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(path_checkpoint, map_location='cpu')
INFO:__main__:Models successfully loaded
WARNING:joblib:[Memory(location=cache/joblib)]: Flushing completely the cache
INFO:__main__:Dataset loaded
  0%|                                                                       | 0/788 [00:00<?, ?it/s]/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/transformers/modeling_utils.py:1044: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/sorgin1/users/jbarrutia006/viper/GLIP/maskrcnn_benchmark/modeling/rpn/vldyhead.py:210: UserWarning: `nn.functional.upsample_bilinear` is deprecated. Use `nn.functional.interpolate` instead.
  temp_fea.append(F.upsample_bilinear(self.DyConv[0](visual_feats[level + 1], **conv_args),
/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  0%|                                                             | 1/788 [00:12<2:39:03, 12.13s/it]  0%|1                                                            | 2/788 [00:26<2:56:36, 13.48s/it]  0%|2                                                            | 3/788 [00:38<2:46:44, 12.74s/it]  1%|3                                                            | 4/788 [00:52<2:55:32, 13.43s/it]  1%|4                                                            | 6/788 [01:16<2:43:16, 12.53s/it]  1%|5                                                            | 7/788 [01:26<2:35:22, 11.94s/it]  1%|6                                                            | 8/788 [01:43<2:51:03, 13.16s/it]  1%|6                                                            | 9/788 [02:00<3:07:25, 14.44s/it]  1%|8                                                           | 11/788 [02:22<2:47:07, 12.91s/it]  2%|9                                                           | 13/788 [02:41<2:29:40, 11.59s/it]  2%|9                                                           | 13/788 [02:59<2:29:40, 11.59s/it]  2%|#1                                                          | 15/788 [03:04<2:28:48, 11.55s/it]  2%|#2                                                          | 16/788 [03:16<2:28:39, 11.55s/it]  2%|#2                                                          | 17/788 [03:30<2:35:41, 12.12s/it]  2%|#3                                                          | 18/788 [03:41<2:32:22, 11.87s/it]  2%|#4                                                          | 19/788 [03:51<2:27:13, 11.49s/it]  3%|#5                                                          | 21/788 [04:09<2:13:08, 10.42s/it]  3%|#5                                                          | 21/788 [04:19<2:13:08, 10.42s/it]  3%|#6                                                          | 22/788 [04:23<2:23:55, 11.27s/it]  3%|#8                                                          | 24/788 [04:43<2:15:45, 10.66s/it]  3%|#8                                                          | 24/788 [04:59<2:15:45, 10.66s/it]  3%|#9                                                          | 26/788 [05:07<2:21:35, 11.15s/it]  3%|##                                                          | 27/788 [05:18<2:21:39, 11.17s/it]  4%|##1                                                         | 28/788 [05:30<2:23:23, 11.32s/it]  4%|##2                                                         | 29/788 [05:41<2:21:51, 11.21s/it]  4%|##2                                                         | 30/788 [05:53<2:24:05, 11.41s/it]  4%|##3                                                         | 31/788 [06:05<2:26:09, 11.58s/it]  4%|##4                                                         | 32/788 [06:17<2:29:07, 11.84s/it]  4%|##5                                                         | 33/788 [06:32<2:39:08, 12.65s/it]  4%|##5                                                         | 34/788 [06:46<2:45:27, 13.17s/it]  4%|##6                                                         | 35/788 [06:58<2:38:01, 12.59s/it]  5%|##7                                                         | 36/788 [07:15<2:54:28, 13.92s/it]  5%|##8                                                         | 37/788 [07:28<2:51:41, 13.72s/it]  5%|##9                                                         | 39/788 [07:53<2:44:48, 13.20s/it]  5%|###                                                         | 40/788 [08:04<2:36:22, 12.54s/it]  5%|###1                                                        | 41/788 [08:16<2:33:59, 12.37s/it]  5%|###2                                                        | 43/788 [08:38<2:28:03, 11.92s/it]  6%|###3                                                        | 44/788 [08:51<2:31:38, 12.23s/it]  6%|###4                                                        | 45/788 [09:03<2:28:56, 12.03s/it]  6%|###5                                                        | 46/788 [09:13<2:23:36, 11.61s/it]  6%|###5                                                        | 47/788 [09:27<2:30:01, 12.15s/it]  6%|###6                                                        | 48/788 [09:40<2:34:00, 12.49s/it]  6%|###7                                                        | 49/788 [09:51<2:27:54, 12.01s/it]  6%|###8                                                        | 50/788 [10:03<2:26:31, 11.91s/it]  6%|###8                                                        | 51/788 [10:19<2:42:19, 13.21s/it]  7%|###9                                                        | 52/788 [10:34<2:46:41, 13.59s/it]  7%|####1                                                       | 54/788 [10:56<2:32:16, 12.45s/it]  7%|####1                                                       | 55/788 [11:06<2:25:17, 11.89s/it]  7%|####2                                                       | 56/788 [11:18<2:26:46, 12.03s/it]  7%|####3                                                       | 57/788 [11:31<2:28:40, 12.20s/it]  7%|####4                                                       | 58/788 [11:45<2:35:51, 12.81s/it]  7%|####4                                                       | 59/788 [12:02<2:50:01, 13.99s/it]  8%|####5                                                       | 60/788 [12:15<2:45:28, 13.64s/it]  8%|####6                                                       | 61/788 [12:26<2:36:45, 12.94s/it]  8%|####7                                                       | 63/788 [12:49<2:27:14, 12.19s/it]  8%|####8                                                       | 64/788 [12:59<2:21:15, 11.71s/it]  8%|####9                                                       | 65/788 [13:12<2:23:53, 11.94s/it]  8%|#####                                                       | 66/788 [13:23<2:22:37, 11.85s/it]  9%|#####1                                                      | 67/788 [13:37<2:28:19, 12.34s/it]  9%|#####1                                                      | 68/788 [13:52<2:36:34, 13.05s/it]  9%|#####2                                                      | 69/788 [14:02<2:26:24, 12.22s/it]  9%|#####4                                                      | 71/788 [14:21<2:12:15, 11.07s/it]  9%|#####4                                                      | 71/788 [14:39<2:12:15, 11.07s/it]  9%|#####5                                                      | 73/788 [14:46<2:16:30, 11.46s/it]  9%|#####6                                                      | 74/788 [14:59<2:20:17, 11.79s/it] 10%|#####7                                                      | 76/788 [15:16<2:04:53, 10.52s/it] 10%|#####7                                                      | 76/788 [15:29<2:04:53, 10.52s/it] 10%|#####9                                                      | 78/788 [15:40<2:10:44, 11.05s/it] 10%|######                                                      | 79/788 [15:55<2:21:23, 11.97s/it] 10%|######                                                      | 80/788 [16:06<2:17:17, 11.63s/it] 10%|######1                                                     | 81/788 [16:17<2:16:23, 11.58s/it] 10%|######2                                                     | 82/788 [16:28<2:15:09, 11.49s/it] 11%|######3                                                     | 84/788 [16:49<2:08:11, 10.93s/it] 11%|######4                                                     | 85/788 [17:00<2:08:16, 10.95s/it] 11%|######6                                                     | 87/788 [17:19<2:01:47, 10.42s/it] 11%|######6                                                     | 87/788 [17:29<2:01:47, 10.42s/it] 11%|######7                                                     | 88/788 [17:30<2:02:53, 10.53s/it] 11%|######8                                                     | 90/788 [17:50<2:00:13, 10.33s/it] 12%|######9                                                     | 91/788 [18:01<2:02:12, 10.52s/it] 12%|#######                                                     | 92/788 [18:13<2:05:46, 10.84s/it] 12%|#######                                                     | 93/788 [18:26<2:11:23, 11.34s/it] 12%|#######1                                                    | 94/788 [18:41<2:23:57, 12.45s/it] 12%|#######2                                                    | 95/788 [18:53<2:20:51, 12.20s/it] 12%|#######3                                                    | 96/788 [19:04<2:16:34, 11.84s/it] 12%|#######3                                                    | 97/788 [19:14<2:12:30, 11.51s/it] 12%|#######4                                                    | 98/788 [19:27<2:15:29, 11.78s/it] 13%|#######5                                                    | 99/788 [19:40<2:21:09, 12.29s/it] 13%|#######4                                                   | 100/788 [19:58<2:39:38, 13.92s/it] 13%|#######5                                                   | 101/788 [20:10<2:33:50, 13.44s/it] 13%|#######6                                                   | 102/788 [20:21<2:24:21, 12.63s/it] 13%|#######7                                                   | 103/788 [20:35<2:29:51, 13.13s/it] 13%|#######7                                                   | 104/788 [20:48<2:26:33, 12.86s/it] 13%|#######8                                                   | 105/788 [21:00<2:22:55, 12.56s/it] 13%|#######9                                                   | 106/788 [21:10<2:14:31, 11.83s/it] 14%|########                                                   | 107/788 [21:20<2:10:04, 11.46s/it] 14%|########                                                   | 108/788 [21:31<2:08:37, 11.35s/it] 14%|########1                                                  | 109/788 [21:46<2:20:31, 12.42s/it] 14%|########2                                                  | 110/788 [21:58<2:19:03, 12.31s/it] 14%|########3                                                  | 112/788 [22:17<2:03:21, 10.95s/it] 14%|########3                                                  | 112/788 [22:29<2:03:21, 10.95s/it] 14%|########5                                                  | 114/788 [22:42<2:09:05, 11.49s/it] 15%|########6                                                  | 115/788 [22:53<2:08:42, 11.47s/it] 15%|########7                                                  | 117/788 [23:13<2:02:11, 10.93s/it] 15%|########9                                                  | 119/788 [23:33<1:57:46, 10.56s/it] 15%|########9                                                  | 119/788 [23:49<1:57:46, 10.56s/it] 15%|#########                                                  | 121/788 [23:56<2:00:22, 10.83s/it] 15%|#########1                                                 | 122/788 [24:08<2:02:55, 11.07s/it] 16%|#########2                                                 | 124/788 [24:28<1:58:25, 10.70s/it] 16%|#########3                                                 | 125/788 [24:42<2:05:30, 11.36s/it] 16%|#########4                                                 | 126/788 [24:52<2:02:48, 11.13s/it] 16%|#########5                                                 | 128/788 [25:13<2:00:19, 10.94s/it] 16%|#########6                                                 | 129/788 [25:31<2:17:05, 12.48s/it] 16%|#########7                                                 | 130/788 [25:43<2:13:44, 12.19s/it] 17%|#########8                                                 | 132/788 [26:04<2:07:22, 11.65s/it] 17%|#########9                                                 | 133/788 [26:17<2:09:32, 11.87s/it] 17%|##########                                                 | 134/788 [26:30<2:13:11, 12.22s/it] 17%|##########1                                                | 135/788 [26:42<2:12:09, 12.14s/it] 17%|##########1                                                | 136/788 [26:54<2:10:51, 12.04s/it] 17%|##########2                                                | 137/788 [27:04<2:05:06, 11.53s/it] 18%|##########3                                                | 138/788 [27:16<2:04:11, 11.46s/it] 18%|##########4                                                | 139/788 [27:31<2:16:56, 12.66s/it] 18%|##########5                                                | 141/788 [27:47<1:53:40, 10.54s/it] 18%|##########5                                                | 141/788 [27:59<1:53:40, 10.54s/it] 18%|##########6                                                | 142/788 [28:02<2:04:31, 11.57s/it] 18%|##########7                                                | 143/788 [28:14<2:07:04, 11.82s/it] 18%|##########8                                                | 145/788 [28:35<2:00:04, 11.21s/it] 19%|##########9                                                | 146/788 [28:47<2:00:49, 11.29s/it] 19%|###########                                                | 147/788 [28:57<1:58:36, 11.10s/it] 19%|###########                                                | 148/788 [29:11<2:06:15, 11.84s/it] 19%|###########1                                               | 149/788 [29:21<2:01:20, 11.39s/it] 19%|###########2                                               | 150/788 [29:32<1:59:22, 11.23s/it] 19%|###########3                                               | 151/788 [29:43<1:58:20, 11.15s/it] 19%|###########3                                               | 152/788 [29:54<1:58:47, 11.21s/it] 19%|###########4                                               | 153/788 [30:05<1:55:39, 10.93s/it] 20%|###########5                                               | 154/788 [30:19<2:06:34, 11.98s/it] 20%|###########6                                               | 155/788 [30:34<2:15:00, 12.80s/it] 20%|###########6                                               | 156/788 [30:44<2:06:39, 12.02s/it] 20%|###########7                                               | 157/788 [30:54<2:00:55, 11.50s/it] 20%|###########8                                               | 158/788 [31:09<2:10:31, 12.43s/it] 20%|###########9                                               | 159/788 [31:20<2:04:21, 11.86s/it] 20%|###########9                                               | 160/788 [31:30<2:00:01, 11.47s/it] 20%|############                                               | 161/788 [31:45<2:10:06, 12.45s/it] 21%|############1                                              | 162/788 [31:59<2:15:51, 13.02s/it] 21%|############2                                              | 163/788 [32:09<2:06:37, 12.16s/it] 21%|############2                                              | 164/788 [32:25<2:19:03, 13.37s/it] 21%|############3                                              | 165/788 [32:36<2:10:34, 12.58s/it] 21%|############4                                              | 166/788 [32:46<2:02:37, 11.83s/it] 21%|############5                                              | 167/788 [33:00<2:07:51, 12.35s/it] 21%|############5                                              | 168/788 [33:12<2:07:47, 12.37s/it] 21%|############6                                              | 169/788 [33:25<2:10:00, 12.60s/it] 22%|############7                                              | 170/788 [33:42<2:21:01, 13.69s/it] 22%|############8                                              | 171/788 [33:56<2:22:59, 13.91s/it] 22%|##