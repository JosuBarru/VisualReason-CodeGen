Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:25<01:43, 25.84s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:42<01:01, 20.55s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:58<00:36, 18.17s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:59<00:11, 11.46s/it]Loading checkpoint shards: 100%|██████████| 5/5 [01:00<00:00,  7.63s/it]Loading checkpoint shards: 100%|██████████| 5/5 [01:00<00:00, 12.01s/it]
INFO:root:BLIP loaded
/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/torch/functional.py:534: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3595.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/sorgin1/users/jbarrutia006/viper/GLIP/maskrcnn_benchmark/utils/checkpoint.py:115: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(f, map_location=torch.device("cpu"))
INFO:root:GLIP model is loaded in cuda:0
/sorgin1/users/jbarrutia006/viper/src/vision_models.py:1992: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(path_checkpoint, map_location='cpu')
INFO:__main__:Models successfully loaded
WARNING:joblib:[Memory(location=cache/joblib)]: Flushing completely the cache
INFO:__main__:Dataset loaded
  0%|                                                                       | 0/788 [00:00<?, ?it/s]/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/transformers/modeling_utils.py:1044: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/sorgin1/users/jbarrutia006/viper/GLIP/maskrcnn_benchmark/modeling/rpn/vldyhead.py:210: UserWarning: `nn.functional.upsample_bilinear` is deprecated. Use `nn.functional.interpolate` instead.
  temp_fea.append(F.upsample_bilinear(self.DyConv[0](visual_feats[level + 1], **conv_args),
/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  0%|                                                             | 1/788 [00:13<3:01:29, 13.84s/it]  0%|2                                                            | 3/788 [00:35<2:30:31, 11.51s/it]  1%|3                                                            | 5/788 [00:53<2:14:42, 10.32s/it]  1%|3                                                            | 5/788 [01:10<2:14:42, 10.32s/it]  1%|5                                                            | 7/788 [01:15<2:19:06, 10.69s/it]  1%|6                                                            | 8/788 [01:29<2:26:39, 11.28s/it]  1%|6                                                            | 9/788 [01:40<2:27:35, 11.37s/it]  1%|8                                                           | 11/788 [01:53<1:58:56,  9.18s/it]  2%|9                                                           | 13/788 [02:03<1:40:36,  7.79s/it]  2%|#1                                                          | 15/788 [02:18<1:37:51,  7.60s/it]  2%|#2                                                          | 17/788 [02:29<1:29:10,  6.94s/it]  2%|#2                                                          | 17/788 [02:40<1:29:10,  6.94s/it]  2%|#4                                                          | 19/788 [02:42<1:26:44,  6.77s/it]  3%|#5                                                          | 21/788 [02:52<1:19:52,  6.25s/it]  3%|#7                                                          | 23/788 [03:04<1:19:02,  6.20s/it]  3%|#9                                                          | 25/788 [03:17<1:19:05,  6.22s/it]  3%|#9                                                          | 25/788 [03:30<1:19:05,  6.22s/it]  3%|##                                                          | 27/788 [03:30<1:19:45,  6.29s/it]  4%|##2                                                         | 29/788 [03:45<1:25:27,  6.76s/it]  4%|##3                                                         | 31/788 [03:58<1:22:34,  6.54s/it]  4%|##3                                                         | 31/788 [04:10<1:22:34,  6.54s/it]  4%|##5                                                         | 33/788 [04:12<1:24:10,  6.69s/it]  4%|##6                                                         | 35/788 [04:26<1:25:21,  6.80s/it]  5%|##8                                                         | 37/788 [04:39<1:24:49,  6.78s/it]  5%|##8                                                         | 37/788 [04:50<1:24:49,  6.78s/it]  5%|##9                                                         | 39/788 [04:55<1:29:31,  7.17s/it]  5%|###1                                                        | 41/788 [05:09<1:28:14,  7.09s/it]  5%|###1                                                        | 41/788 [05:20<1:28:14,  7.09s/it]  5%|###2                                                        | 43/788 [05:21<1:24:04,  6.77s/it]  6%|###4                                                        | 45/788 [05:33<1:20:22,  6.49s/it]  6%|###5                                                        | 47/788 [05:46<1:20:50,  6.55s/it]  6%|###7                                                        | 49/788 [05:57<1:16:47,  6.23s/it]  6%|###7                                                        | 49/788 [06:10<1:16:47,  6.23s/it]  6%|###8                                                        | 51/788 [06:12<1:21:31,  6.64s/it]  7%|####1                                                       | 54/788 [06:27<1:12:39,  5.94s/it]  7%|####1                                                       | 54/788 [06:40<1:12:39,  5.94s/it]  7%|####3                                                       | 57/788 [06:46<1:13:44,  6.05s/it]  7%|####4                                                       | 59/788 [06:59<1:14:43,  6.15s/it]  7%|####4                                                       | 59/788 [07:10<1:14:43,  6.15s/it]  8%|####6                                                       | 61/788 [07:15<1:21:11,  6.70s/it]  8%|####7                                                       | 63/788 [07:26<1:17:18,  6.40s/it]  8%|####9                                                       | 65/788 [07:37<1:13:41,  6.11s/it]  9%|#####1                                                      | 67/788 [07:48<1:10:40,  5.88s/it]  9%|#####1                                                      | 67/788 [08:00<1:10:40,  5.88s/it]  9%|#####3                                                      | 70/788 [08:02<1:05:13,  5.45s/it]  9%|#####3                                                      | 70/788 [08:20<1:05:13,  5.45s/it]  9%|#####5                                                      | 73/788 [08:20<1:06:52,  5.61s/it] 10%|#####7                                                      | 76/788 [08:35<1:04:17,  5.42s/it] 10%|######                                                      | 79/788 [08:49<1:01:05,  5.17s/it] 10%|######                                                      | 79/788 [09:00<1:01:05,  5.17s/it] 10%|######1                                                     | 81/788 [09:03<1:07:05,  5.69s/it] 11%|######3                                                     | 83/788 [09:14<1:06:06,  5.63s/it] 11%|######4                                                     | 85/788 [09:26<1:05:56,  5.63s/it] 11%|######6                                                     | 87/788 [09:39<1:09:24,  5.94s/it] 11%|######6                                                     | 87/788 [09:50<1:09:24,  5.94s/it] 11%|######7                                                     | 89/788 [09:54<1:14:10,  6.37s/it] 12%|######9                                                     | 91/788 [10:08<1:16:26,  6.58s/it] 12%|######9                                                     | 91/788 [10:20<1:16:26,  6.58s/it] 12%|#######                                                     | 93/788 [10:20<1:13:03,  6.31s/it] 12%|#######                                                     | 93/788 [10:30<1:13:03,  6.31s/it] 12%|#######2                                                    | 95/788 [10:30<1:08:59,  5.97s/it] 12%|#######3                                                    | 97/788 [10:40<1:05:37,  5.70s/it] 13%|#######5                                                    | 99/788 [10:52<1:06:15,  5.77s/it] 13%|#######5                                                   | 101/788 [11:05<1:08:17,  5.96s/it] 13%|#######7                                                   | 103/788 [11:15<1:05:09,  5.71s/it] 13%|#######8                                                   | 105/788 [11:26<1:03:56,  5.62s/it] 14%|########                                                   | 107/788 [11:37<1:04:38,  5.70s/it] 14%|########                                                   | 107/788 [11:50<1:04:38,  5.70s/it] 14%|########1                                                  | 109/788 [11:50<1:06:21,  5.86s/it] 14%|########3                                                  | 111/788 [12:03<1:08:44,  6.09s/it] 14%|########4                                                  | 113/788 [12:14<1:06:29,  5.91s/it] 15%|########6                                                  | 115/788 [12:27<1:07:09,  5.99s/it] 15%|#########1                                                   | 118/788 [12:39<59:21,  5.32s/it] 15%|#########1                                                   | 118/788 [12:50<59:21,  5.32s/it] 15%|#########2                                                   | 120/788 [12:50<58:56,  5.29s/it] 15%|#########4                                                   | 122/788 [13:01<59:15,  5.34s/it] 16%|#########3                                                 | 125/788 [13:18<1:01:14,  5.54s/it] 16%|#########3                                                 | 125/788 [13:30<1:01:14,  5.54s/it] 16%|#########5                                                 | 127/788 [13:31<1:03:14,  5.74s/it] 16%|#########6                                                 | 129/788 [13:47<1:09:53,  6.36s/it] 17%|#########8                                                 | 131/788 [13:58<1:07:08,  6.13s/it] 17%|#########8                                                 | 131/788 [14:10<1:07:08,  6.13s/it] 17%|##########                                                 | 134/788 [14:15<1:04:55,  5.96s/it] 17%|##########1                                                | 136/788 [14:27<1:04:49,  5.97s/it] 18%|##########3                                                | 138/788 [14:38<1:03:18,  5.84s/it] 18%|##########4                                                | 140/788 [14:49<1:02:05,  5.75s/it] 18%|##########4                                                | 140/788 [15:00<1:02:05,  5.75s/it] 18%|###########                                                  | 143/788 [15:04<58:39,  5.46s/it] 19%|###########3                                                 | 146/788 [15:19<56:02,  5.24s/it] 19%|###########3                                                 | 146/788 [15:30<56:02,  5.24s/it] 19%|###########5                                                 | 149/788 [15:35<56:14,  5.28s/it] 19%|###########5                                                 | 149/788 [15:50<56:14,  5.28s/it] 19%|###########7                                                 | 152/788 [15:50<55:41,  5.25s/it] 20%|###########9                                                 | 154/788 [16:02<56:54,  5.39s/it] 20%|############                                                 | 156/788 [16:15<59:19,  5.63s/it] 20%|############2                                                | 158/788 [16:25<58:36,  5.58s/it] 20%|############3                                                | 160/788 [16:36<56:53,  5.44s/it] 20%|############3                                                | 160/788 [16:50<56:53,  5.44s/it] 21%|############6                                                | 163/788 [16:51<55:44,  5.35s/it] 21%|############7                                                | 165/788 [17:04<58:13,  5.61s/it] 21%|############9                                                | 167/788 [17:16<59:13,  5.72s/it] 21%|#############                                                | 169/788 [17:27<58:33,  5.68s/it] 21%|#############                                                | 169/788 [17:40<58:33,  5.68s/it] 22%|############8                                              | 171/788 [17:40<1:00:05,  5.84s/it] 22%|############8                                              | 171/788 [17:50<1:00:05,  5.84s/it] 22%|#############3                                               | 173/788 [17:50<57:54,  5.65s/it] 22%|#############5                                               | 175/788 [18:02<59:34,  5.83s/it] 23%|#############7                                               | 178/788 [18:17<55:15,  5.43s/it] 23%|#############7                                               | 178/788 [18:30<55:15,  5.43s/it] 23%|##############                                               | 181/788 [18:36<58:56,  5.83s/it] 23%|##############1                                              | 183/788 [18:49<59:42,  5.92s/it] 23%|##############1                                              | 183/788 [19:00<59:42,  5.92s/it] 23%|##############3                                              | 185/788 [19:00<58:29,  5.82s/it] 24%|##############5                                              | 188/788 [19:17<57:42,  5.77s/it] 24%|##############7                                              | 190/788 [19:30<58:45,  5.89s/it] 24%|##############7                                              | 190/788 [19:40<58:45,  5.89s/it] 24%|##############3                                            | 192/788 [19:44<1:02:38,  6.31s/it] 25%|##############5                                            | 194/788 [19:56<1:01:17,  6.19s/it] 25%|##############5                                            | 194/788 [20:10<1:01:17,  6.19s/it] 25%|##############6                                            | 196/788 [20:10<1:03:00,  6.39s/it] 25%|###############3                                             | 198/788 [20:20<59:03,  6.01s/it] 25%|##############9                                            | 200/788 [20:34<1:00:57,  6.22s/it] 26%|###############7                                             | 203/788 [20:47<54:10,  5.56s/it] 26%|###############7                                             | 203/788 [21:00<54:10,  5.56s/it] 26%|###############8                                             | 205/788 [21:00<56:16,  5.79s/it] 26%|################                                             | 207/788 [21:10<54:12,  5.60s/it] 27%|################2                                            | 210/788 [21:25<51:48,  5.38s/it] 27%|################4                                            | 212/788 [21:36<52:01,  5.42s/it] 27%|################6                                            | 215/788 [21:48<47:11,  4.94s/it] 27%|################6                                            | 215/788 [22:00<47:11,  4.94s/it] 28%|################8                                            | 218/788 [22:03<46:24,  4.89s/it] 28%|################8                                            | 218/788 [22:20<46:24,  4.89s/it] 28%|#################1                                           | 221/788 [22:23<51:27,  5.45s/it] 28%|#################2                                           | 223/788 [22:35<52:44,  5.60s/it] 28%|#################2                                           | 223/788 [22:50<52:44,  5.60s/it] 29%|################8                                          | 225/788 [22:52<1:00:06,  6.40s/it] 29%|################9                                          | 227/788 [23:06<1:00:27,  6.47s/it] 29%|#################8                                           | 230/788 [23:18<52:44,  5.67s/it] 29%|#################8                                           | 230/788 [23:30<52:44,  5.67s/it] 30%|##################                                           | 233/788 [23:35<51:31,  5.57s/it] 30%|##################                                           | 233/788 [23:50<51:31,  5.57s/it] 30%|##################1                                          | 235/788 [23:50<56:31,  6.13s/it] 30%|##################4                                          | 238/788 [24:06<53:18,  5.82s/it] 30%|##################4                                          | 238/788 [24:20<53:18,  5.82s/it] 30%|##################5                                          | 240/788 [24:21<56:42,  6.21s/it] 31%|##################7                                          | 242/788 [24:34<58:00,  6.37s/it] 31%|##################2                                        | 244/788 [24:50<1:00:44,  6.70s/it] 31%|##################2                                        | 244/788 [25:00<1:00:44,  6.70s/it] 31%|##################4                                        | 246/788 [25:03<1:00:49,  6.73s/it] 31%|###################1                                         | 248/788 [25:16<59:43,  6.64s/it] 32%|###################3                                         | 250/788 [25:28<58:12,  6.49s/it] 32%|###################3                                         | 250/788 [25:40<58:12,  6.49s/it] 32%|##################8                                        | 252/788 [25:43<1:00:48,  6.81s/it] 32%|###################                                        | 254/788 [25:57<1:00:57,  6.85s/it] 32%|###################                                        | 254/788 [26:10<1:00:57,  6.85s/it] 32%|###################1                                       | 256/788 [26:12<1:02:26,  7.04s/it] 33%|###################9                                         | 258/788 [26:23<57:22,  6.50s/it] 33%|####################1                                        | 260/788 [26:35<56:08,  6.38s/it] 33%|####################2                                        | 262/788 [26:49<57:15,  6.53s/it] 33%|####################2                                        | 262/788 [27:00<57:15,  6.53s/it] 34%|####################4                                        | 264/788 [27:02<57:26,  6.58s/it] 34%|####################6                                        | 267/788 [27:17<51:31,  5.93s/it] 34%|####################6                                        | 267/788 [27:30<51:31,  5.93s/it] 34%|####################8                                        | 269/788 [27:30<52:37,  6.08s/it] 34%|####################9                                        | 271/788 [27:45<55:30,  6.44s/it] 35%|#####################1                                       | 273/788 [27:57<54:11,  6.31s/it] 35%|#####################1                                       | 273/788 [28:10<54:11,  6.31s/it] 35%|#####################2                                       | 275/788 [28:12<57:35,  6.74s/it] 35%|#####################4                                       | 277/788 [28:25<57:02,  6.70s/it] 35%|#####################5                                       | 279/788 [28:38<55:32,  6.55s/it] 35%|#####################5                                       | 279/788 [28:50<55:32,  6.55s/it] 36%|#####################7                                       | 281/788 [28:50<54:35,  6.46s/it] 36%|#####################9                                       | 283/788 [29:04<55:06,  6.55s/it] 36%|######################                                       | 285/788 [29:15<52:57,  6.32s/it] 36%|######################                                       | 285/788 [29:30<52:57,  6.32s/it] 36%|######################2                                      | 287/788 [29:31<56:15,  6.74s/it] 37%|######################3                                      | 289/788 [29:42<52:57,  6.37s/it] 37%|######################5                                      | 291/788 [29:53<50:38,  6.11s/it] 37%|######################6                                      | 293/788 [30:05<50:19,  6.10s/it] 37%|######################8                                      | 295/788 [30:17<50:08,  6.10s/it] 37%|######################8                                      | 295/788 [30:30<50:08,  6.10s/it] 38%|#######################                                      | 298/788 [30:31<45:31,  5.57s/it] 38%|#######################                                      | 298/788 [30:50<45:31,  5.57s/it] 38%|#######################3                                     | 301/788 [30:52<48:36,  5.99s/it] 38%|#######################4                                     | 303/788 [31:04<49:25,  6.12s/it] 38%|#######################4                                     | 303/788 [31:20<49:25,  6.12s/it] 39%|#######################6                                     | 305/788 [31:21<53:58,  6.70s/it] 39%|#######################7                                     | 307/788 [31:34<53:10,  6.63s/it] 39%|#######################9                                     | 309/788 [31:48<53:45,  6.73s/it] 39%|#######################9                                     | 309/788 [32:00<53:45,  6.73s/it] 39%|########################                                     | 311/788 [32:02<53:53,  6.78s/it] 40%|########################2                                    | 313/788 [32:16<54:21,  6.87s/it] 40%|########################3                                    | 315/788 [32:29<52:53,  6.71s/it] 40%|########################3                                    | 315/788 [32:40<52:53,  6.71s/it] 40%|########################5                                    | 317/788 [32:42<52:08,  6.64s/it] 40%|########################6                                    | 319/788 [32:56<53:34,  6.85s/it] 41%|########################8                                    | 321/788 [33:07<50:15,  6.46s/it] 41%|########################8                                    | 321/788 [33:20<50:15,  6.46s/it] 41%|#########################                                    | 323/788 [33:20<49:29,  6.39s/it] 41%|#########################1                                   | 325/788 [33:34<51:30,  6.68s/it] 41%|#########################3                                   | 327/788 [33:45<47:42,  6.21s/it] 42%|#########################4                                   | 329/788 [33:56<46:16,  6.05s/it] 42%|#########################4                                   | 329/788 [34:10<46:16,  6.05s/it] 42%|#########################6                                   | 331/788 [34:10<48:09,  6.32s/it] 42%|#########################7                                   | 333/788 [34:26<51:17,  6.76s/it] 43%|#########################9                                   | 335/788 [34:37<48:19,  6.40s/it] 43%|#########################9                                   | 335/788 [34:50<48:19,  6.40s/it] 43%|##########################                                   | 337/788 [34:52<50:28,  6.72s/it] 43%|##########################2                                  | 339/788 [35:02<47:13,  6.31s/it] 43%|##########################3                                  | 341/788 [35:16<48:25,  6.50s/it] 44%|##########################5                                  | 343/788 [35:29<48:19,  6.51s/it] 44%|##########################5                                  | 343/788 [35:40<48:19,  6.51s/it] 44%|##########################7                                  | 345/788 [35:43<49:11,  6.66s/it] 44%|##########################8                                  | 347/788 [35:54<45:56,  6.25s/it] 44%|###########################                                  | 350/788 [36:09<42:15,  5.79s/it] 44%|###########################                                  | 350/788 [36:20<42:15,  5.79s/it] 45%|###########################2                                 | 352/788 [36:21<42:22,  5.83s/it] 45%|###########################4                                 | 355/788 [36:36<39:38,  5.49s/it] 45%|###########################4                                 | 355/788 [36:50<39:38,  5.49s/it] 45%|###########################7                                 | 358/788 [36:53<40:09,  5.60s/it] 46%|###########################8                                 | 360/788 [37:05<40:07,  5.62s/it] 46%|############################                                 | 362/788 [37:18<42:03,  5.92s/it] 46%|############################1                                | 364/788 [37:28<40:16,  5.70s/it] 46%|############################1                                | 364/788 [37:40<40:16,  5.70s/it] 46%|############################3                                | 366/788 [37:40<40:24,  5.75s/it] 47%|############################5                                | 369/788 [37:53<36:41,  5.25s/it] 47%|############################5                                | 369/788 [38:10<36:41,  5.25s/it] 47%|############################7                                | 372/788 [38:14<40:23,  5.82s/it] 47%|############################9                                | 374/788 [38:25<40:04,  5.81s/it] 48%|#############################1                               | 376/788 [38:37<39:31,  5.76s/it] 48%|#############################2                               | 378/788 [38:47<38:24,  5.62s/it] 48%|#############################2                               | 378/788 [39:00<38:24,  5.62s/it] 48%|#############################4                               | 380/788 [39:00<39:59,  5.88s/it] 48%|#############################5                               | 382/788 [39:13<40:21,  5.96s/it] 49%|#############################7                               | 384/788 [39:23<38:59,  5.79s/it] 49%|#############################8                               | 386/788 [39:36<40:05,  5.98s/it] 49%|##############################                               | 388/788 [39:47<38:29,  5.77s/it] 49%|##############################                               | 388/788 [40:00<38:29,  5.77s/it] 49%|##############################1                              | 390/788 [40:01<40:30,  6.11s/it] 50%|##############################3                              | 392/788 [40:13<40:40,  6.16s/it] 50%|##############################5                              | 394/788 [40:26<41:14,  6.28s/it] 50%|##############################5                              | 394/788 [40:40<41:14,  6.28s/it] 50%|##############################6                              | 396/788 [40:41<43:17,  6.63s/it] 51%|##############################8                              | 398/788 [40:54<42:19,  6.51s/it] 51%|###############################                              | 401/788 [41:08<37:36,  5.83s/it] 51%|###############################                              | 401/788 [41:20<37:36,  5.83s/it] 51%|###############################2                             | 404/788 [41:23<35:34,  5.56s/it] 52%|###############################4                             | 406/788 [41:35<36:11,  5.69s/it] 52%|###############################5                             | 408/788 [41:47<36:26,  5.76s/it] 52%|###############################7                             | 410/788 [41:58<35:51,  5.69s/it] 52%|###############################8                             | 412/788 [42:09<35:10,  5.61s/it] 52%|###############################8                             | 412/788 [42:20<35:10,  5.61s/it] 53%|################################                             | 414/788 [42:22<36:10,  5.80s/it] 53%|################################2                            | 416/788 [42:33<35:44,  5.77s/it] 53%|################################3                            | 418/788 [42:44<35:01,  5.68s/it] 53%|################################5                            | 420/788 [42:58<37:23,  6.10s/it] 54%|################################6                            | 422/788 [43:09<36:03,  5.91s/it] 54%|################################6                            | 422/788 [43:20<36:03,  5.91s/it] 54%|################################8                            | 424/788 [43:23<37:45,  6.22s/it] 54%|################################8                            | 424/788 [43:40<37:45,  6.22s/it] 54%|#################################                            | 427/788 [43:40<36:04,  6.00s/it] 54%|#################################2                           | 429/788 [43:52<35:33,  5.94s/it] 55%|#################################3                           | 431/788 [44:05<36:32,  6.14s/it] 55%|#################################5                           | 433/788 [44:16<35:32,  6.01s/it] 55%|#################################5                           | 433/788 [44:30<35:32,  6.01s/it] 55%|#################################7                           | 436/788 [44:30<32:22,  5.52s/it] 55%|#################################7                           | 436/788 [44:50<32:22,  5.52s/it] 56%|#################################9                           | 439/788 [44:51<34:39,  5.96s/it] 56%|##################################2                          | 442/788 [45:08<33:45,  5.85s/it] 56%|##################################2                          | 442/788 [45:20<33:45,  5.85s/it] 56%|##################################3                          | 444/788 [45:21<35:04,  6.12s/it] 57%|##################################5                          | 446/788 [45:34<34:57,  6.13s/it] 57%|##################################6                          | 448/788 [45:47<35:31,  6.27s/it] 57%|##################################6                          | 448/788 [46:00<35:31,  6.27s/it] 57%|##################################8                          | 450/788 [46:00<35:54,  6.38s/it] 57%|##################################9                          | 452/788 [46:12<35:05,  6.27s/it] 58%|###################################1                         | 454/788 [46:23<33:26,  6.01s/it] 58%|###################################1                         | 454/788 [46:40<33:26,  6.01s/it] 58%|###################################2                         | 456/788 [46:43<39:51,  7.20s/it] 58%|###################################4                         | 458/788 [46:56<38:29,  7.00s/it] 58%|###################################4                         | 458/788 [47:10<38:29,  7.00s/it] 58%|###################################6                         | 460/788 [47:12<39:44,  7.27s/it] 59%|###################################7                         | 462/788 [47:25<37:57,  6.98s/it] 59%|###################################9                         | 464/788 [47:36<35:43,  6.62s/it] 59%|####################################                         | 466/788 [47:48<34:12,  6.37s/it] 59%|####################################                         | 466/788 [48:00<34:12,  6.37s/it] 59%|####################################1                        | 467/788 [48:01<40:38,  7.60s/it] 60%|####################################3                        | 469/788 [48:11<35:50,  6.74s/it] 60%|####################################4                        | 471/788 [48:22<33:13,  6.29s/it] 60%|####################################6                        | 473/788 [48:33<31:19,  5.97s/it] 60%|####################################7                        | 475/788 [48:45<31:29,  6.04s/it] 60%|####################################7                        | 475/788 [49:00<31:29,  6.04s/it] 61%|#####################################                        | 478/788 [49:00<29:15,  5.66s/it] 61%|#####################################1                       | 480/788 [49:17<32:45,  6.38s/it] 61%|#####################################3                       | 482/788 [49:29<32:01,  6.28s/it] 61%|#####################################3                       | 482/788 [49:40<32:01,  6.28s/it] 61%|#####################################4                       | 484/788 [49:42<32:37,  6.44s/it] 62%|#####################################6                       | 486/788 [49:54<31:29,  6.26s/it] 62%|#####################################7                       | 488/788 [50:05<30:01,  6.00s/it] 62%|#####################################9                       | 490/788 [50:15<28:38,  5.77s/it] 62%|######################################                       | 492/788 [50:26<27:56,  5.66s/it] 63%|######################################2                      | 494/788 [50:38<28:02,  5.72s/it] 63%|######################################2                      | 494/788 [50:50<28:02,  5.72s/it] 63%|######################################3                      | 496/788 [50:51<28:45,  5.91s/it] 63%|######################################5                      | 498/788 [51:02<28:34,  5.91s/it] 63%|######################################7                      | 500/788 [51:14<28:13,  5.88s/it] 64%|######################################8                      | 502/788 [51:25<27:48,  5.83s/it] 64%|######################################8                      | 502/788 [51:40<27:48,  5.83s/it] 64%|#######################################                      | 504/788 [51:40<29:45,  6.29s/it] 64%|#######################################2                     | 507/788 [51:54<26:12,  5.60s/it] 65%|#######################################4                     | 510/788 [52:09<25:20,  5.47s/it] 65%|#######################################4                     | 510/788 [52:20<25:20,  5.47s/it] 65%|#######################################6                     | 512/788 [52:23<26:42,  5.80s/it] 65%|#######################################7                     | 514/788 [52:35<26:36,  5.83s/it] 65%|#######################################9                     | 516/788 [52:48<27:05,  5.98s/it] 65%|#######################################9                     | 516/788 [53:00<27:05,  5.98s/it] 66%|########################################                     | 518/788 [53:01<27:55,  6.21s/it] 66%|########################################2                    | 520/788 [53:14<27:50,  6.23s/it] 66%|########################################2                    | 520/788 [53:30<27:50,  6.23s/it] 66%|########################################4                    | 523/788 [53:30<26:00,  5.89s/it] 67%|########################################6                    | 525/788 [53:42<25:56,  5.92s/it] 67%|########################################7                    | 527/788 [53:54<26:07,  6.01s/it] 67%|########################################9                    | 529/788 [54:07<26:13,  6.08s/it] 67%|#########################################1                   | 531/788 [54:17<24:52,  5.81s/it] 68%|#########################################2                   | 533/788 [54:29<25:10,  5.92s/it] 68%|#########################################2                   | 533/788 [54:40<25:10,  5.92s/it] 68%|#########################################4                   | 535/788 [54:41<24:32,  5.82s/it] 68%|#########################################5                   | 537/788 [54:52<24:16,  5.80s/it] 68%|#########################################7                   | 539/788 [55:07<25:51,  6.23s/it] 68%|#########################################7                   | 539/788 [55:20<25:51,  6.23s/it] 69%|#########################################9                   | 542/788 [55:27<26:24,  6.44s/it] 69%|##########################################1                  | 544/788 [55:39<25:53,  6.37s/it] 69%|##########################################1                  | 544/788 [55:50<25:53,  6.37s/it] 69%|##########################################2                  | 546/788 [55:54<26:42,  6.62s/it] 70%|##########################################4                  | 548/788 [56:09<27:27,  6.86s/it] 70%|##########################################4                  | 548/788 [56:20<27:27,  6.86s/it] 70%|##########################################5                  | 550/788 [56:21<26:12,  6.61s/it] 70%|##########################################7                  | 552/788 [56:34<26:09,  6.65s/it] 70%|##########################################8                  | 554/788 [56:50<27:07,  6.96s/it] 70%|##########################################8                  | 554/788 [57:00<27:07,  6.96s/it] 71%|###########################################                  | 556/788 [57:00<25:04,  6.49s/it] 71%|###########################################1                 | 558/788 [57:12<24:15,  6.33s/it] 71%|###########################################3                 | 560/788 [57:25<24:04,  6.33s/it] 71%|###########################################5                 | 562/788 [57:38<24:03,  6.39s/it] 71%|###########################################5                 | 562/788 [57:50<24:03,  6.39s/it] 72%|###########################################6                 | 564/788 [57:55<26:11,  7.01s/it] 72%|###########################################8                 | 566/788 [58:06<24:20,  6.58s/it] 72%|###########################################8                 | 566/788 [58:20<24:20,  6.58s/it] 72%|###########################################9                 | 568/788 [58:22<25:25,  6.93s/it] 72%|############################################1                | 570/788 [58:33<23:50,  6.56s/it] 73%|############################################2                | 572/788 [58:45<23:13,  6.45s/it] 73%|############################################4                | 574/788 [58:58<22:55,  6.43s/it] 73%|############################################4                | 574/788 [59:10<22:55,  6.43s/it] 73%|############################################5                | 576/788 [59:12<23:19,  6.60s/it] 73%|############################################7                | 578/788 [59:24<22:13,  6.35s/it] 74%|############################################8                | 580/788 [59:38<22:49,  6.59s/it] 74%|############################################8                | 580/788 [59:50<22:49,  6.59s/it] 74%|#############################################                | 582/788 [59:50<22:17,  6.49s/it] 74%|###########################################7               | 584/788 [1:00:04<22:16,  6.55s/it] 74%|###########################################8               | 586/788 [1:00:17<22:08,  6.58s/it] 75%|############################################               | 588/788 [1:00:27<20:29,  6.15s/it] 75%|############################################               | 588/788 [1:00:40<20:29,  6.15s/it] 75%|############################################1              | 590/788 [1:00:43<22:02,  6.68s/it] 75%|############################################3              | 592/788 [1:00:57<21:55,  6.71s/it] 75%|############################################4              | 594/788 [1:01:07<20:11,  6.24s/it] 75%|############################################4              | 594/788 [1:01:20<20:11,  6.24s/it] 76%|############################################6              | 596/788 [1:01:22<21:19,  6.66s/it] 76%|############################################8              | 599/788 [1:01:35<18:02,  5.73s/it] 76%|#############################################              | 602/788 [1:01:48<16:18,  5.26s/it] 76%|#############################################              | 602/788 [1:02:00<16:18,  5.26s/it] 77%|#############################################2             | 604/788 [1:02:04<18:11,  5.93s/it] 77%|#############################################3             | 606/788 [1:02:18<18:43,  6.17s/it] 77%|#############################################3             | 606/788 [1:02:30<18:43,  6.17s/it] 77%|#############################################5             | 608/788 [1:02:32<19:14,  6.42s/it] 78%|#############################################7             | 611/788 [1:02:47<17:14,  5.85s/it] 78%|#############################################7             | 611/788 [1:03:00<17:14,  5.85s/it] 78%|#############################################8             | 613/788 [1:03:03<18:37,  6.39s/it] 78%|##############################################             | 615/788 [1:03:14<17:54,  6.21s/it] 78%|##############################################2            | 618/788 [1:03:29<16:20,  5.77s/it] 78%|##############################################2            | 618/788 [1:03:40<16:20,  5.77s/it] 79%|##############################################4            | 621/788 [1:03:47<16:17,  5.86s/it] 79%|##############################################6            | 623/788 [1:03:57<15:37,  5.68s/it] 79%|##############################################6            | 623/788 [1:04:10<15:37,  5.68s/it] 79%|##############################################8            | 626/788 [1:04:13<14:57,  5.54s/it] 80%|###############################################            | 628/788 [1:04:25<15:00,  5.63s/it] 80%|###############################################1           | 630/788 [1:04:37<15:00,  5.70s/it] 80%|###############################################3           | 632/788 [1:04:48<14:49,  5.70s/it] 80%|###############################################3           | 632/788 [1:05:00<14:49,  5.70s/it] 80%|###############################################4           | 634/788 [1:05:03<15:40,  6.11s/it] 80%|###############################################4           | 634/788 [1:05:20<15:40,  6.11s/it] 81%|###############################################6           | 637/788 [1:05:20<15:02,  5.98s/it] 81%|###############################################8           | 639/788 [1:05:32<14:48,  5.97s/it] 81%|###############################################9           | 641/788 [1:05:42<14:00,  5.72s/it] 82%|################################################1          | 643/788 [1:05:52<13:30,  5.59s/it] 82%|################################################2          | 645/788 [1:06:05<13:44,  5.76s/it] 82%|################################################4          | 647/788 [1:06:19<14:19,  6.10s/it] 82%|################################################5          | 649/788 [1:06:29<13:29,  5.82s/it] 82%|################################################5          | 649/788 [1:06:40<13:29,  5.82s/it] 83%|################################################7          | 651/788 [1:06:40<13:08,  5.76s/it] 83%|################################################8          | 653/788 [1:06:56<14:19,  6.37s/it] 83%|################################################8          | 653/788 [1:07:10<14:19,  6.37s/it] 83%|#################################################1         | 656/788 [1:07:10<12:37,  5.74s/it] 84%|#################################################3         | 659/788 [1:07:29<12:44,  5.93s/it] 84%|#################################################4         | 661/788 [1:07:40<12:17,  5.81s/it] 84%|#################################################4         | 661/788 [1:07:50<12:17,  5.81s/it] 84%|#################################################6         | 663/788 [1:07:52<12:14,  5.88s/it] 84%|#################################################7         | 665/788 [1:08:05<12:26,  6.07s/it] 85%|#################################################9         | 667/788 [1:08:16<11:54,  5.90s/it] 85%|##################################################         | 669/788 [1:08:28<11:46,  5.94s/it] 85%|##################################################         | 669/788 [1:08:40<11:46,  5.94s/it] 85%|##################################################2        | 671/788 [1:08:41<11:55,  6.11s/it] 85%|##################################################3        | 673/788 [1:08:52<11:16,  5.88s/it] 86%|##################################################5        | 675/788 [1:09:02<10:38,  5.65s/it] 86%|##################################################6        | 677/788 [1:09:14<10:34,  5.72s/it] 86%|##################################################8        | 679/788 [1:09:25<10:25,  5.74s/it] 86%|##################################################9        | 681/788 [1:09:37<10:24,  5.84s/it] 86%|##################################################9        | 681/788 [1:09:50<10:24,  5.84s/it] 87%|###################################################1       | 683/788 [1:09:52<10:59,  6.28s/it] 87%|###################################################2       | 685/788 [1:10:06<11:07,  6.48s/it] 87%|###################################################4       | 687/788 [1:10:17<10:28,  6.23s/it] 87%|###################################################5       | 689/788 [1:10:28<09:52,  5.99s/it] 88%|###################################################7       | 691/788 [1:10:40<09:36,  5.95s/it] 88%|###################################################7       | 691/788 [1:10:50<09:36,  5.95s/it] 88%|###################################################9       | 694/788 [1:10:54<08:33,  5.47s/it] 88%|###################################################9       | 694/788 [1:11:10<08:33,  5.47s/it] 88%|####################################################1      | 697/788 [1:11:10<08:12,  5.41s/it] 89%|####################################################3      | 699/788 [1:11:22<08:20,  5.62s/it] 89%|####################################################5      | 702/788 [1:11:36<07:34,  5.28s/it] 89%|####################################################5      | 702/788 [1:11:50<07:34,  5.28s/it] 89%|####################################################7      | 705/788 [1:11:54<07:32,  5.45s/it] 90%|####################################################9      | 707/788 [1:12:05<07:23,  5.48s/it] 90%|#####################################################      | 709/788 [1:12:16<07:16,  5.53s/it] 90%|#####################################################2     | 711/788 [1:12:28<07:09,  5.58s/it] 90%|#####################################################3     | 713/788 [1:12:38<06:55,  5.54s/it] 91%|#####################################################5     | 715/788 [1:12:48<06:33,  5.39s/it] 91%|#####################################################5     | 715/788 [1:13:00<06:33,  5.39s/it] 91%|#####################################################6     | 717/788 [1:13:01<06:45,  5.71s/it] 91%|#####################################################8     | 719/788 [1:13:14<06:44,  5.86s/it] 91%|#####################################################9     | 721/788 [1:13:26<06:34,  5.89s/it] 92%|######################################################1    | 723/788 [1:13:36<06:09,  5.69s/it] 92%|######################################################2    | 725/788 [1:13:47<05:49,  5.54s/it] 92%|######################################################4    | 727/788 [1:13:58<05:44,  5.65s/it] 93%|######################################################5    | 729/788 [1:14:10<05:32,  5.64s/it] 93%|######################################################5    | 729/788 [1:14:20<05:32,  5.64s/it] 93%|######################################################7    | 731/788 [1:14:22<05:30,  5.80s/it] 93%|######################################################9    | 734/788 [1:14:39<05:07,  5.70s/it] 93%|######################################################9    | 734/788 [1:14:50<05:07,  5.70s/it] 93%|#######################################################1   | 736/788 [1:14:50<04:55,  5.67s/it] 94%|#######################################################3   | 739/788 [1:15:05<04:28,  5.48s/it] 94%|#######################################################4   | 741/788 [1:15:16<04:15,  5.44s/it] 94%|#######################################################6   | 743/788 [1:15:27<04:03,  5.41s/it] 95%|#######################################################7   | 745/788 [1:15:38<03:56,  5.51s/it] 95%|#######################################################9   | 747/788 [1:15:49<03:43,  5.45s/it] 95%|#######################################################9   | 747/788 [1:16:00<03:43,  5.45s/it] 95%|########################################################   | 749/788 [1:16:00<03:35,  5.53s/it] 95%|########################################################3  | 752/788 [1:16:16<03:15,  5.43s/it] 96%|########################################################4  | 754/788 [1:16:28<03:08,  5.56s/it] 96%|########################################################6  | 756/788 [1:16:38<02:55,  5.48s/it] 96%|########################################################6  | 756/788 [1:16:50<02:55,  5.48s/it] 96%|########################################################7  | 758/788 [1:16:50<02:46,  5.55s/it] 96%|########################################################9  | 760/788 [1:17:02<02:38,  5.68s/it] 97%|#########################################################1 | 763/788 [1:17:17<02:15,  5.42s/it] 97%|#########################################################1 | 763/788 [1:17:30<02:15,  5.42s/it] 97%|#########################################################3 | 766/788 [1:17:35<02:04,  5.66s/it] 97%|#########################################################5 | 768/788 [1:17:47<01:55,  5.78s/it] 97%|#########################################################5 | 768/788 [1:18:00<01:55,  5.78s/it] 98%|#########################################################7 | 771/788 [1:18:01<01:30,  5.34s/it] 98%|#########################################################9 | 774/788 [1:18:17<01:15,  5.39s/it] 98%|##########################################################1| 776/788 [1:18:28<01:04,  5.35s/it] 98%|##########################################################1| 776/788 [1:18:40<01:04,  5.35s/it] 99%|##########################################################3| 779/788 [1:18:44<00:48,  5.37s/it] 99%|##########################################################4| 781/788 [1:18:56<00:38,  5.48s/it] 99%|##########################################################6| 783/788 [1:19:06<00:27,  5.41s/it]100%|##########################################################7| 785/788 [1:19:17<00:16,  5.46s/it]100%|##########################################################7| 785/788 [1:19:30<00:16,  5.46s/it]100%|##########################################################9| 787/788 [1:19:30<00:05,  5.69s/it]100%|###########################################################| 788/788 [1:19:33<00:00,  6.06s/it]
Traceback (most recent call last):
  File "/sorgin1/users/jbarrutia006/viper/src/main_project_slurm.py", line 334, in <module>
    main()
  File "/sorgin1/users/jbarrutia006/viper/src/main_project_slurm.py", line 325, in main
    save_results(all_data, dataset)
  File "/sorgin1/users/jbarrutia006/viper/src/main_project_slurm.py", line 155, in save_results
    filename = filename + config.cached_codex_path.split("/")[-1] + datetime.now().strftime("%m-%d_%H-%M") +'.csv'
               ^^^^^^^^
UnboundLocalError: cannot access local variable 'filename' where it is not associated with a value
srun: error: localhost: task 0: Exited with exit code 1
