Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:25<01:43, 25.84s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:42<01:01, 20.55s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:58<00:36, 18.17s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:59<00:11, 11.46s/it]Loading checkpoint shards: 100%|██████████| 5/5 [01:00<00:00,  7.63s/it]Loading checkpoint shards: 100%|██████████| 5/5 [01:00<00:00, 12.01s/it]
INFO:root:BLIP loaded
/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/torch/functional.py:534: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3595.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/sorgin1/users/jbarrutia006/viper/GLIP/maskrcnn_benchmark/utils/checkpoint.py:115: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(f, map_location=torch.device("cpu"))
INFO:root:GLIP model is loaded in cuda:0
/sorgin1/users/jbarrutia006/viper/src/vision_models.py:1992: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(path_checkpoint, map_location='cpu')
INFO:__main__:Models successfully loaded
WARNING:joblib:[Memory(location=cache/joblib)]: Flushing completely the cache
INFO:__main__:Dataset loaded
  0%|                                                                       | 0/788 [00:00<?, ?it/s]/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/transformers/modeling_utils.py:1044: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/sorgin1/users/jbarrutia006/viper/GLIP/maskrcnn_benchmark/modeling/rpn/vldyhead.py:210: UserWarning: `nn.functional.upsample_bilinear` is deprecated. Use `nn.functional.interpolate` instead.
  temp_fea.append(F.upsample_bilinear(self.DyConv[0](visual_feats[level + 1], **conv_args),
/sorgin1/users/jbarrutia006/venvs/viper_tximista/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:633: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  0%|                                                             | 1/788 [00:13<3:01:29, 13.84s/it]  0%|2                                                            | 3/788 [00:35<2:30:31, 11.51s/it]  1%|3                                                            | 5/788 [00:53<2:14:42, 10.32s/it]  1%|3                                                            | 5/788 [01:10<2:14:42, 10.32s/it]  1%|5                                                            | 7/788 [01:15<2:19:06, 10.69s/it]  1%|6                                                            | 8/788 [01:29<2:26:39, 11.28s/it]  1%|6                                                            | 9/788 [01:40<2:27:35, 11.37s/it]  1%|8                                                           | 11/788 [01:53<1:58:56,  9.18s/it]  2%|9                                                           | 13/788 [02:03<1:40:36,  7.79s/it]  2%|#1                                                          | 15/788 [02:18<1:37:51,  7.60s/it]  2%|#2                                                          | 17/788 [02:29<1:29:10,  6.94s/it]  2%|#2                                                          | 17/788 [02:40<1:29:10,  6.94s/it]  2%|#4                                                          | 19/788 [02:42<1:26:44,  6.77s/it]  3%|#5                                                          | 21/788 [02:52<1:19:52,  6.25s/it]  3%|#7                                                          | 23/788 [03:04<1:19:02,  6.20s/it]  3%|#9                                                          | 25/788 [03:17<1:19:05,  6.22s/it]  3%|#9                                                          | 25/788 [03:30<1:19:05,  6.22s/it]  3%|##                                                          | 27/788 [03:30<1:19:45,  6.29s/it]  4%|##2                                                         | 29/788 [03:45<1:25:27,  6.76s/it]  4%|##3                                                         | 31/788 [03:58<1:22:34,  6.54s/it]  4%|##3                                                         | 31/788 [04:10<1:22:34,  6.54s/it]  4%|##5                                                         | 33/788 [04:12<1:24:10,  6.69s/it]  4%|##6                                                         | 35/788 [04:26<1:25:21,  6.80s/it]  5%|##8                                                         | 37/788 [04:39<1:24:49,  6.78s/it]  5%|##8                                                         | 37/788 [04:50<1:24:49,  6.78s/it]  5%|##9                                                         | 39/788 [04:55<1:29:31,  7.17s/it]  5%|###1                                                        | 41/788 [05:09<1:28:14,  7.09s/it]  5%|###1                                                        | 41/788 [05:20<1:28:14,  7.09s/it]  5%|###2                                                        | 43/788 [05:21<1:24:04,  6.77s/it]  6%|###4                                                        | 45/788 [05:33<1:20:22,  6.49s/it]  6%|###5                                                        | 47/788 [05:46<1:20:50,  6.55s/it]  6%|###7                                                        | 49/788 [05:57<1:16:47,  6.23s/it]  6%|###7                                                        | 49/788 [06:10<1:16:47,  6.23s/it]  6%|###8                                                        | 51/788 [06:12<1:21:31,  6.64s/it]  7%|####1                                                       | 54/788 [06:27<1:12:39,  5.94s/it]  7%|####1                                                       | 54/788 [06:40<1:12:39,  5.94s/it]  7%|####3                                                       | 57/788 [06:46<1:13:44,  6.05s/it]  7%|####4                                                       | 59/788 [06:59<1:14:43,  6.15s/it]  7%|####4                                                       | 59/788 [07:10<1:14:43,  6.15s/it]  8%|####6                                                       | 61/788 [07:15<1:21:11,  6.70s/it]  8%|####7                                                       | 63/788 [07:26<1:17:18,  6.40s/it]  8%|####9                                                       | 65/788 [07:37<1:13:41,  6.11s/it]  9%|#####1                                                      | 67/788 [07:48<1:10:40,  5.88s/it]  9%|#####1                                                      | 67/788 [08:00<1:10:40,  5.88s/it]  9%|#####3                                                      | 70/788 [08:02<1:05:13,  5.45s/it]  9%|#####3                                                      | 70/788 [08:20<1:05:13,  5.45s/it]  9%|#####5                                                      | 73/788 [08:20<1:06:52,  5.61s/it] 10%|#####7                                                      | 76/788 [08:35<1:04:17,  5.42s/it] 10%|######                                                      | 79/788 [08:49<1:01:05,  5.17s/it] 10%|######                                                      | 79/788 [09:00<1:01:05,  5.17s/it] 10%|######1                                                     | 81/788 [09:03<1:07:05,  5.69s/it] 11%|######3                                                     | 83/788 [09:14<1:06:06,  5.63s/it] 11%|######4                                                     | 85/788 [09:26<1:05:56,  5.63s/it] 11%|######6                                                     | 87/788 [09:39<1:09:24,  5.94s/it] 11%|######6                                                     | 87/788 [09:50<1:09:24,  5.94s/it] 11%|######7                                                     | 89/788 [09:54<1:14:10,  6.37s/it] 12%|######9                                                     | 91/788 [10:08<1:16:26,  6.58s/it] 12%|######9                                                     | 91/788 [10:20<1:16:26,  6.58s/it] 12%|#######                                                     | 93/788 [10:20<1:13:03,  6.31s/it] 12%|#######                                                     | 93/788 [10:30<1:13:03,  6.31s/it] 12%|#######2                                                    | 95/788 [10:30<1:08:59,  5.97s/it] 12%|#######3                                                    | 97/788 [10:40<1:05:37,  5.70s/it] 13%|#######5                                                    | 99/788 [10:52<1:06:15,  5.77s/it] 13%|#######5                                                   | 101/788 [11:05<1:08:17,  5.96s/it] 13%|#######7                                                   | 103/788 [11:15<1:05:09,  5.71s/it] 13%|#######8                                                   | 105/788 [11:26<1:03:56,  5.62s/it] 14%|########                                                   | 107/788 [11:37<1:04:38,  5.70s/it] 14%|########                                                   | 107/788 [11:50<1:04:38,  5.70s/it] 14%|########1                                                  | 109/788 [11:50<1:06:21,  5.86s/it] 14%|########3                                                  | 111/788 [12:03<1:08:44,  6.09s/it] 14%|########4                                                  | 113/788 [12:14<1:06:29,  5.91s/it] 15%|########6                                                  | 115/788 [12:27<1:07:09,  5.99s/it] 15%|#########1                                                   | 118/788 [12:39<59:21,  5.32s/it] 15%|#########1                                                   | 118/788 [12:50<59:21,  5.32s/it] 15%|#########2                                                   | 120/788 [12:50<58:56,  5.29s/it] 15%|#########4                                                   | 122/788 [13:01<59:15,  5.34s/it] 16%|#########3                                                 | 125/788 [13:18<1:01:14,  5.54s/it] 16%|#########3                                                 | 125/788 [13:30<1:01:14,  5.54s/it] 16%|#########5                                                 | 127/788 [13:31<1:03:14,  5.74s/it] 16%|#########6                                                 | 129/788 [13:47<1:09:53,  6.36s/it] 17%|#########8                                                 | 131/788 [13:58<1:07:08,  6.13s/it] 17%|#########8                                                 | 131/788 [14:10<1:07:08,  6.13s/it] 17%|##########                                                 | 134/788 [14:15<1:04:55,  5.96s/it] 17%|##########1                                                | 136/788 [14:27<1:04:49,  5.97s/it] 18%|##########3                                                | 138/788 [14:38<1:03:18,  5.84s/it] 18%|##########4                                                | 140/788 [14:49<1:02:05,  5.75s/it] 18%|##########4                                                | 140/788 [15:00<1:02:05,  5.75s/it] 18%|###########                                                  | 143/788 [15:04<58:39,  5.46s/it] 19%|###########3                                                 | 146/788 [15:19<56:02,  5.24s/it] 19%|###########3                                                 | 146/788 [15:30<56:02,  5.24s/it] 19%|###########5                                                 | 149/788 [15:35<56:14,  5.28s/it] 19%|###########5                                                 | 149/788 [15:50<56:14,  5.28s/it] 19%|###########7                                                 | 152/788 [15:50<55:41,  5.25s/it] 20%|###########9                                                 | 154/788 [16:02<56:54,  5.39s/it] 20%|############                                                 | 156/788 [16:15<59:19,  5.63s/it] 20%|############2                                                | 158/788 [16:25<58:36,  5.58s/it] 20%|############3                                                | 160/788 [16:36<56:53,  5.44s/it] 20%|############3                                                | 160/788 [16:50<56:53,  5.44s/it] 21%|############6                                                | 163/788 [16:51<55:44,  5.35s/it] 21%|############7                                                | 165/788 [17:04<58:13,  5.61s/it] 21%|############9                                                | 167/788 [17:16<59:13,  5.72s/it] 21%|#############                                                | 169/788 [17:27<58:33,  5.68s/it] 21%|#############                                                | 169/788 [17:40<58:33,  5.68s/it] 22%|############8                                              | 171/788 [17:40<1:00:05,  5.84s/it] 22%|############8                                              | 171/788 [17:50<1:00:05,  5.84s/it] 22%|#############3                                               | 173/788 [17:50<57:54,  5.65s/it] 22%|#############5                                               | 175/788 [18:02<59:34,  5.83s/it] 23%|#############7                                               | 178/788 [18:17<55:15,  5.43s/it] 23%|#############7                                               | 178/788 [18:30<55:15,  5.43s/it] 23%|##############                                               | 181/788 [18:36<58:56,  5.83s/it] 23%|##############1                                              | 183/788 [18:49<59:42,  5.92s/it] 23%|##############1                                              | 183/788 [19:00<59:42,  5.92s/it] 23%|##############3                                              | 185/788 [19:00<58:29,  5.82s/it] 24%|##############5                                              | 188/788 [19:17<57:42,  5.77s/it] 24%|##############7                                              | 190/788 [19:30<58:45,  5.89s/it] 24%|##############7                                              | 190/788 [19:40<58:45,  5.89s/it] 24%|##############3                                            | 192/788 [19:44<1:02:38,  6.31s/it] 25%|##############5                                            | 194/788 [19:56<1:01:17,  6.19s/it] 25%|##############5                                            | 194/788 [20:10<1:01:17,  6.19s/it] 25%|##############6                                            | 196/788 [20:10<1:03:00,  6.39s/it] 25%|###############3                                             | 198/788 [20:20<59:03,  6.01s/it] 25%|##############9                                            | 200/788 [20:34<1:00:57,  6.22s/it] 26%|###############7                                             | 203/788 [20:47<54:10,  5.56s/it] 26%|###############7                                             | 203/788 [21:00<54:10,  5.56s/it] 26%|###############8                                             | 205/788 [21:00<56:16,  5.79s/it] 26%|################                                             | 207/788 [21:10<54:12,  5.60s/it] 27%|################2                                            | 210/788 [21:25<51:48,  5.38s/it] 27%|################4                                            | 212/788 [21:36<52:01,  5.42s/it] 27%|################6                                            | 215/788 [21:48<47:11,  4.94s/it] 27%|################6                                            | 215/788 [22:00<47:11,  4.94s/it] 28%|################8                                            | 218/788 [22:03<46:24,  4.89s/it] 28%|################8                                            | 218/788 [22:20<46:24,  4.89s/it] 28%|#################1                                           | 221/788 [22:23<51:27,  5.45s/it] 28%|#################2                                           | 223/788 [22:35<52:44,  5.60s/it] 28%|#################2                                           | 223/788 [22:50<52:44,  5.60s/it] 29%|################8                                          | 225/788 [22:52<1:00:06,  6.40s/it] 29%|################9                                          | 227/788 [23:06<1:00:27,  6.47s/it] 29%|#################8                                           | 230/788 [23:18<52:44,  5.67s/it] 29%|#################8                                           | 230/788 [23:30<52:44,  5.67s/it] 30%|##################                                           | 233/788 [23:35<51:31,  5.57s/it] 30%|##################                                           | 233/788 [23:50<51:31,  5.57s/it] 30%|##################1                                          | 235/788 [23:50<56:31,  6.13s/it] 30%|##################4                                          | 238/788 [24:06<53:18,  5.82s/it] 30%|##################4                                          | 238/788 [24:20<53:18,  5.82s/it] 30%|##################5                                          | 240/788 [24:21<56:42,  6.21s/it] 31%|##################7                                          | 242/788 [24:34<58:00,  6.37s/it] 31%|##################2                                        | 244/788 [24:50<1:00:44,  6.70s/it] 31%|##################2                                        | 244/788 [25:00<1:00:44,  6.70s/it] 31%|##################4                                        | 246/788 [25:03<1:00:49,  6.73s/it] 31%|###################1                                         | 248/788 [25:16<59:43,  6.64s/it] 32%|###################3                                         | 250/788 [25:28<58:12,  6.49s/it] 32%|###################3                                         | 250/788 [25:40<58:12,  6.49s/it] 32%|##################8                                        | 252/788 [25:43<1:00:48,  6.81s/it] 32%|###################                                        | 254/788 [25:57<1:00:57,  6.85s/it] 32%|###################                                        | 254/788 [26:10<1:00:57,  6.85s/it] 32%|###################1                                       | 256/788 [26:12<1:02:26,  7.04s/it] 33%|###################9                                         | 258/788 [26:23<57:22,  6.50s/it] 33%|####################1                                        | 260/788 [26:35<56:08,  6.38s/it] 33%|####################2                                        | 262/788 [26:49<57:15,  6.53s/it] 33%|####################2                                        | 262/788 [27:00<57:15,  6.53s/it] 34%|####################4                                        | 264/788 [27:02<57:26,  6.58s/it] 34%|####################6                                        | 267/788 [27:17<51:31,  5.93s/it] 34%|####################6                                        | 267/788 [27:30<51:31,  5.93s/it] 34%|####################8                                        | 269/788 [27:30<52:37,  6.08s/it] 34%|####################9                                        | 271/788 [27:45<55:30,  6.44s/it] 35%|#####################1                                       | 273/788 [27:57<54:11,  6.31s/it] 35%|#####################1                                       | 273/788 [28:10<54:11,  6.31s/it] 35%|#####################2                                       | 275/788 [28:12<57:35,  6.74s/it] 35%|#####################4                                       | 277/788 [28:25<57:02,  6.70s/it] 35%|#####################5                                       | 279/788 [28:38<55:32,  6.55s/it] 35%|#####################5                                       | 279/788 [28:50<55:32,  6.55s/it] 36%|#####################7                                       | 281/788 [28:50<54:35,  6.46s/it] 36%|#####################9                                       | 283/788 [29:04<55:06,  6.55s/it] 36%|######################                                       | 285/788 [29:15<52:57,  6.32s/it] 36%|######################                                       | 285/788 [29:30<52:57,  6.32s/it] 36%|######################2                                      | 287/788 [29:31<56:15,  6.74s/it] 37%|######################3                                      | 289/788 [29:42<52:57,  6.37s/it] 37%|######################5                                      | 291/788 [29:53<50:38,  6.11s/it] 37%|######################6                                      | 293/788 [30:05<50:19,  6.10s/it] 37%|######################8                                      | 295/788 [30:17<50:08,  6.10s/it] 37%|######################8                                      | 295/788 [30:30<50:08,  6.10s/it] 38%|#######################                                      | 298/788 [30:31<45:31,  5.57s/it] 38%|#######################                                      | 298/788 [30:50<45:31,  5.57s/it] 38%|#######################3                                     | 301/788 [30:52<48:36,  5.99s/it] 38%|#######################4                                     | 303/788 [31:04<49:25,  6.12s/it] 38%|#######################4                                     | 303/788 [31:20<49:25,  6.12s/it] 39%|#######################6                                     | 305/788 [31:21<53:58,  6.70s/it] 39%|#######################7                                     | 307/788 [31:34<53:10,  6.63s/it] 39%|#######################9                                     | 309/788 [31:48<53:45,  6.73s/it] 39%|#######################9                                     | 309/788 [32:00<53:45,  6.73s/it] 39%|########################                                     | 311/788 [32:02<53:53,  6.78s/it] 40%|########################2                                    | 313/788 [32:16<54:21,  6.87s/it] 40%|########################3                                    | 315/788 [32:29<52:53,  6.71s/it] 40%|########################3                                    | 315/788 [32:40<52:53,  6.71s/it] 40%|########################5                                    | 317/788 [32:42<52:08,  6.64s/it] 40%|########################6                                    | 319/788 [32:56<53:34,  6.85s/it] 41%|########################8                                    | 321/788 [33:07<50:15,  6.46s/it] 41%|########################8                                    | 321/788 [33:20<50:15,  6.46s/it] 41%|#########################                                    | 323/788 [33:20<49:29,  6.39s/it] 41%|#########################1                                   | 325/788 [33:34<51:30,  6.68s/it] 41%|#########################3                                   | 327/788 [33:45<47:42,  6.21s/it] 42%|#########################4                                   | 329/788 [33:56<46:16,  6.05s/it] 42%|#########################4                                   | 329/788 [34:10<46:16,  6.05s/it] 42%|#########################6                                   | 331/788 [34:10<48:09,  6.32s/it] 42%|#########################7                                   | 333/788 [34:26<51:17,  6.76s/it] 43%|#########################9                                   | 335/788 [34:37<48:19,  6.40s/it] 43%|#########################9                                   | 335/788 [34:50<48:19,  6.40s/it] 43%|##########################                                   | 337/788 [34:52<50:28,  6.72s/it] 43%|##########################2                                  | 339/788 [35:02<47:13,  6.31s/it] 43%|##########################3                                  | 341/788 [35:16<48:25,  6.50s/it] 44%|##########################5                                  | 343/788 [35:29<48:19,  6.51s/it] 44%|##########################5                                  | 343/788 [35:40<48:19,  6.51s/it] 44%|##########################7                                  | 345/788 [35:43<49:11,  